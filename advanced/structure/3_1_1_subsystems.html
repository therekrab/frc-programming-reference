<!DOCTYPE html>

<html :class="{'dark': darkMode === 'dark' || (darkMode === 'system' &amp;&amp; window.matchMedia('(prefers-color-scheme: dark)').matches)}" class="scroll-smooth" data-content_root="../../" lang="en" x-data="{ darkMode: localStorage.getItem('darkMode') || localStorage.setItem('darkMode', 'system'), activeSection: '' }" x-init="$watch('darkMode', val =&gt; localStorage.setItem('darkMode', val))">
<head>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<meta charset="utf-8"/>
<meta content="white" media="(prefers-color-scheme: light)" name="theme-color"/>
<meta content="black" media="(prefers-color-scheme: dark)" name="theme-color"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<title>3.1.1 - Subsystems | The Programming Reference Book</title>
<meta content="3.1.1 - Subsystems | The Programming Reference Book" property="og:title"/>
<meta content="3.1.1 - Subsystems | The Programming Reference Book" name="twitter:title"/>
<link href="../../_static/pygments.css?v=e72c8e07" rel="stylesheet" type="text/css"/>
<link href="../../_static/theme.css?v=42baaae4" rel="stylesheet" type="text/css"/>
<link href="../../_static/favicon.png" rel="icon"/>
<link href="../../search.html" rel="search" title="Search"/>
<link href="../../genindex.html" rel="index" title="Index"/>
<link href="3_1_2_superstructure.html" rel="next" title="3.1.2 - Superstructures and States"/>
<link href="index.html" rel="prev" title="3.1 - Program Structure"/>
<script>
    <!-- Prevent Flash of wrong theme -->
      const userPreference = localStorage.getItem('darkMode');
      let mode;
      if (userPreference === 'dark' || window.matchMedia('(prefers-color-scheme: dark)').matches) {
        mode = 'dark';
        document.documentElement.classList.add('dark');
      } else {
        mode = 'light';
      }
      if (!userPreference) {localStorage.setItem('darkMode', mode)}
    </script>
</head>
<body :class="{ 'overflow-hidden': showSidebar }" @scroll.window="showScrollTop = pageYOffset &gt; 100" class="min-h-screen font-sans antialiased bg-background text-foreground" x-data="{ showSidebar: false, showScrollTop: false }">
<div @click.self="showSidebar = false" class="fixed inset-0 z-50 overflow-hidden bg-background/80 backdrop-blur-sm md:hidden" x-cloak="" x-show="showSidebar"></div><div class="relative flex flex-col min-h-screen" id="page"><a class="absolute top-0 left-0 z-[100] block bg-background p-4 text-xl transition -translate-x-full opacity-0 focus:translate-x-0 focus:opacity-100" href="#content">
      Skip to content
    </a><header class="sticky top-0 z-40 w-full border-b shadow-sm border-border supports-backdrop-blur:bg-background/60 bg-background/95 backdrop-blur"><div class="container flex items-center h-14">
<div class="hidden mr-4 md:flex">
<a class="flex items-center mr-6" href="../../index.html">
<img alt="Logo" class="mr-2 hidden dark:block" height="24" src="../../_static/favicon.png" width="24"/>
<img alt="Logo" class="mr-2 dark:hidden" height="24" src="../../_static/favicon.png" width="24"/><span class="hidden font-bold sm:inline-block text-clip whitespace-nowrap">The Programming Reference Book</span>
</a></div><button @click="showSidebar = true" class="inline-flex items-center justify-center h-10 px-0 py-2 mr-2 text-base font-medium transition-colors rounded-md hover:text-accent-foreground hover:bg-transparent md:hidden" type="button">
<svg aria-hidden="true" fill="currentColor" height="24" viewbox="0 96 960 960" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M152.587 825.087q-19.152 0-32.326-13.174t-13.174-32.326q0-19.152 13.174-32.326t32.326-13.174h440q19.152 0 32.326 13.174t13.174 32.326q0 19.152-13.174 32.326t-32.326 13.174h-440Zm0-203.587q-19.152 0-32.326-13.174T107.087 576q0-19.152 13.174-32.326t32.326-13.174h320q19.152 0 32.326 13.174T518.087 576q0 19.152-13.174 32.326T472.587 621.5h-320Zm0-203.587q-19.152 0-32.326-13.174t-13.174-32.326q0-19.152 13.174-32.326t32.326-13.174h440q19.152 0 32.326 13.174t13.174 32.326q0 19.152-13.174 32.326t-32.326 13.174h-440ZM708.913 576l112.174 112.174q12.674 12.674 12.674 31.826t-12.674 31.826Q808.413 764.5 789.261 764.5t-31.826-12.674l-144-144Q600 594.391 600 576t13.435-31.826l144-144q12.674-12.674 31.826-12.674t31.826 12.674q12.674 12.674 12.674 31.826t-12.674 31.826L708.913 576Z"></path>
</svg>
<span class="sr-only">Toggle navigation menu</span>
</button>
<div class="flex items-center justify-between flex-1 space-x-2 sm:space-x-4 md:justify-end">
<div class="flex-1 w-full md:w-auto md:flex-none"><form @keydown.k.window.meta="$refs.search.focus()" action="../../search.html" class="relative flex items-center group" id="searchbox" method="get">
<input aria-label="Search the docs" class="inline-flex items-center font-medium transition-colors bg-transparent focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 ring-offset-background border border-input hover:bg-accent focus:bg-accent hover:text-accent-foreground focus:text-accent-foreground hover:placeholder-accent-foreground py-2 px-4 relative h-9 w-full justify-start rounded-[0.5rem] text-sm text-muted-foreground sm:pr-12 md:w-40 lg:w-64" id="search-input" name="q" placeholder="Search ..." type="search" x-ref="search"/>
<kbd class="pointer-events-none absolute right-1.5 top-2 hidden h-5 select-none text-muted-foreground items-center gap-1 rounded border border-border bg-muted px-1.5 font-mono text-[10px] font-medium opacity-100 sm:flex group-hover:bg-accent group-hover:text-accent-foreground">
<span class="text-xs">⌘</span>
    K
  </kbd>
</form>
</div>
<nav class="flex items-center space-x-1">
<button @click="darkMode = darkMode === 'light' ? 'dark' : 'light'" aria-label="Color theme switcher" class="relative inline-flex items-center justify-center px-0 text-sm font-medium transition-colors rounded-md hover:bg-accent hover:text-accent-foreground h-9 w-9" type="button">
<svg class="absolute transition-all scale-100 rotate-0 dark:-rotate-90 dark:scale-0" fill="currentColor" height="24" viewbox="0 96 960 960" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M480 685q45.456 0 77.228-31.772Q589 621.456 589 576q0-45.456-31.772-77.228Q525.456 467 480 467q-45.456 0-77.228 31.772Q371 530.544 371 576q0 45.456 31.772 77.228Q434.544 685 480 685Zm0 91q-83 0-141.5-58.5T280 576q0-83 58.5-141.5T480 376q83 0 141.5 58.5T680 576q0 83-58.5 141.5T480 776ZM80 621.5q-19.152 0-32.326-13.174T34.5 576q0-19.152 13.174-32.326T80 530.5h80q19.152 0 32.326 13.174T205.5 576q0 19.152-13.174 32.326T160 621.5H80Zm720 0q-19.152 0-32.326-13.174T754.5 576q0-19.152 13.174-32.326T800 530.5h80q19.152 0 32.326 13.174T925.5 576q0 19.152-13.174 32.326T880 621.5h-80Zm-320-320q-19.152 0-32.326-13.174T434.5 256v-80q0-19.152 13.174-32.326T480 130.5q19.152 0 32.326 13.174T525.5 176v80q0 19.152-13.174 32.326T480 301.5Zm0 720q-19.152 0-32.326-13.17Q434.5 995.152 434.5 976v-80q0-19.152 13.174-32.326T480 850.5q19.152 0 32.326 13.174T525.5 896v80q0 19.152-13.174 32.33-13.174 13.17-32.326 13.17ZM222.174 382.065l-43-42Q165.5 327.391 166 308.239t13.174-33.065q13.435-13.674 32.587-13.674t32.065 13.674l42.239 43q12.674 13.435 12.555 31.706-.12 18.272-12.555 31.946-12.674 13.674-31.445 13.413-18.772-.261-32.446-13.174Zm494 494.761-42.239-43q-12.674-13.435-12.674-32.087t12.674-31.565Q686.609 756.5 705.38 757q18.772.5 32.446 13.174l43 41.761Q794.5 824.609 794 843.761t-13.174 33.065Q767.391 890.5 748.239 890.5t-32.065-13.674Zm-42-494.761Q660.5 369.391 661 350.62q.5-18.772 13.174-32.446l41.761-43Q728.609 261.5 747.761 262t33.065 13.174q13.674 13.435 13.674 32.587t-13.674 32.065l-43 42.239q-13.435 12.674-31.706 12.555-18.272-.12-31.946-12.555Zm-495 494.761Q165.5 863.391 165.5 844.239t13.674-32.065l43-42.239q13.435-12.674 32.087-12.674t31.565 12.674Q299.5 782.609 299 801.38q-.5 18.772-13.174 32.446l-41.761 43Q231.391 890.5 212.239 890t-33.065-13.174ZM480 576Z"></path>
</svg>
<svg class="absolute transition-all scale-0 rotate-90 dark:rotate-0 dark:scale-100" fill="currentColor" height="24" viewbox="0 96 960 960" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M480 936q-151 0-255.5-104.5T120 576q0-138 90-239.5T440 218q25-3 39 18t-1 44q-17 26-25.5 55t-8.5 61q0 90 63 153t153 63q31 0 61.5-9t54.5-25q21-14 43-1.5t19 39.5q-14 138-117.5 229T480 936Zm0-80q88 0 158-48.5T740 681q-20 5-40 8t-40 3q-123 0-209.5-86.5T364 396q0-20 3-40t8-40q-78 32-126.5 102T200 576q0 116 82 198t198 82Zm-10-270Z"></path>
</svg>
</button>
</nav>
</div>
</div>
</header>
<div class="flex-1"><div class="container flex-1 items-start md:grid md:grid-cols-[220px_minmax(0,1fr)] md:gap-6 lg:grid-cols-[240px_minmax(0,1fr)] lg:gap-10"><aside :aria-hidden="!showSidebar" :class="{ 'translate-x-0': showSidebar }" class="fixed inset-y-0 left-0 md:top-14 z-50 md:z-30 bg-background md:bg-transparent transition-all duration-100 -translate-x-full md:translate-x-0 ml-0 p-6 md:p-0 md:-ml-2 md:h-[calc(100vh-3.5rem)] w-5/6 md:w-full shrink-0 overflow-y-auto border-r border-border md:sticky" id="left-sidebar">
<a class="!justify-start text-sm md:!hidden bg-background" href="../../index.html">
<img alt="Logo" class="mr-2 hidden dark:block" height="16" src="../../_static/favicon.png" width="16"/>
<img alt="Logo" class="mr-2 dark:hidden" height="16" src="../../_static/favicon.png" width="16"/><span class="font-bold text-clip whitespace-nowrap">The Programming Reference Book</span>
</a>
<div class="relative overflow-hidden md:overflow-auto my-4 md:my-0 h-[calc(100vh-8rem)] md:h-auto">
<div class="overflow-y-auto h-full w-full relative pr-6"><nav class="table w-full min-w-full my-6 lg:my-8">
<p class="caption" role="heading"><span class="caption-text">Contents</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../why_learn_programming.html">Why Learn Programming?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../get_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../glossary.html">Glossary</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">1 - Git &amp; Version Control</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../git/1_1_version_control.html">1.1 - Version Control</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../git/1_2_what_is_git.html">1.2 - What is <code class="docutils literal notranslate"><span class="pre">git</span></code>?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../git/1_3_github.html">1.3 - GitHub</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../git/1_4_merges.html">1.4 - Merges</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">2 - Intro to FRC Programming</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../intro_frc/2_1_wpilib.html">2.1 - WPILib</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../intro_frc/2_2_why_organize.html">2.2 - Why Organize Code?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../intro_frc/2_3_subsystems.html">2.3 - Subsystems</a></li>
<li class="toctree-l1" x-data="{ expanded: $el.classList.contains('current') ? true : false }"><a :class="{ 'expanded' : expanded }" @click="expanded = !expanded" class="reference internal expandable" href="../../intro_frc/commands/index.html">2.4 - Commands<button @click.prevent.stop="expanded = !expanded" type="button"><span class="sr-only"></span><svg fill="currentColor" height="18px" stroke="none" viewbox="0 0 24 24" width="18px" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg></button></a><ul x-show="expanded">
<li class="toctree-l2"><a class="reference internal" href="../../intro_frc/commands/2_4_1_structure.html">2.4.1 - Command structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../intro_frc/commands/2_4_2_interrupts.html">2.4.2 - Interrupting Commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../intro_frc/commands/2_4_3_subclassing.html">2.4.3 - Subclassing Commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../intro_frc/commands/2_4_4_compositions.html">2.4.4 - Command Compositions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../intro_frc/commands/2_4_5_factories.html">2.4.5 - Command Factories</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../intro_frc/commands/2_4_6_decorators.html">2.4.6 - Command Decorators</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../intro_frc/commands/2_4_7_inline.html">2.4.7 - Inline Commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../intro_frc/commands/2_4_8_default.html">2.4.8 - Default Commands</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../intro_frc/commands/2_4_9_proxy.html">2.4.9 - Proxy Commands</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../intro_frc/2_5_triggers.html">2.5 - Triggers</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../intro_frc/2_6_scheduler.html">2.6 - Command Scheduler</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">3 - Advanced FRC Programming</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../3_0_about.html">3.0 - Guide to the Advanced Section</a></li>
<li class="toctree-l1 current" x-data="{ expanded: $el.classList.contains('current') ? true : false }"><a :class="{ 'expanded' : expanded }" @click="expanded = !expanded" class="reference internal expandable" href="index.html">3.1 - Program Structure<button @click.prevent.stop="expanded = !expanded" type="button"><span class="sr-only"></span><svg fill="currentColor" height="18px" stroke="none" viewbox="0 0 24 24" width="18px" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg></button></a><ul class="current" x-show="expanded">
<li class="toctree-l2 current"><a class="current reference internal" href="#">3.1.1 - Subsystems</a></li>
<li class="toctree-l2"><a class="reference internal" href="3_1_2_superstructure.html">3.1.2 - Superstructures and States</a></li>
<li class="toctree-l2"><a class="reference internal" href="3_1_3_binders.html">3.1.3 - Binders</a></li>
<li class="toctree-l2"><a class="reference internal" href="3_1_4_state_theory.html">3.1.4 - State, Theory</a></li>
<li class="toctree-l2"><a class="reference internal" href="3_1_5_state_application.html">3.1.5 - State, Applications</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../3_2_status_signals.html">3.2 - Tips for CTRE Status Signals</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3_3_logging.html">3.3 - Logging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../3_4_localization.html">3.4 - Localization</a></li>
<li class="toctree-l1" x-data="{ expanded: $el.classList.contains('current') ? true : false }"><a :class="{ 'expanded' : expanded }" @click="expanded = !expanded" class="reference internal expandable" href="../debugging/index.html">3.5 - Debugging<button @click.prevent.stop="expanded = !expanded" type="button"><span class="sr-only"></span><svg fill="currentColor" height="18px" stroke="none" viewbox="0 0 24 24" width="18px" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg></button></a><ul x-show="expanded">
<li class="toctree-l2"><a class="reference internal" href="../debugging/3_5_1_causes.html">3.5.1 - What Causes Buggy Code?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../debugging/3_5_2_identify.html">3.5.2 - Identify the Issue</a></li>
<li class="toctree-l2"><a class="reference internal" href="../debugging/3_5_3_correct.html">3.5.3 - Find and Correct</a></li>
<li class="toctree-l2"><a class="reference internal" href="../debugging/3_5_4_tips.html">3.5.4 - Debugging Tips &amp; Tricks</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">4 - Programming Writeups</span></p>
<ul>
<li class="toctree-l1" x-data="{ expanded: $el.classList.contains('current') ? true : false }"><a :class="{ 'expanded' : expanded }" @click="expanded = !expanded" class="reference internal expandable" href="../../writeups/index.html">4 - Writeups<button @click.prevent.stop="expanded = !expanded" type="button"><span class="sr-only"></span><svg fill="currentColor" height="18px" stroke="none" viewbox="0 0 24 24" width="18px" xmlns="http://www.w3.org/2000/svg"><path d="M10 6L8.59 7.41 13.17 12l-4.58 4.59L10 18l6-6z"></path></svg></button></a><ul class="simple" x-show="expanded">
</ul>
</li>
</ul>
</nav>
</div>
</div>
<button @click="showSidebar = false" class="absolute md:hidden right-4 top-4 rounded-sm opacity-70 transition-opacity hover:opacity-100" type="button">
<svg class="h-4 w-4" fill="currentColor" height="24" stroke="none" viewbox="0 96 960 960" width="24" xmlns="http://www.w3.org/2000/svg">
<path d="M480 632 284 828q-11 11-28 11t-28-11q-11-11-11-28t11-28l196-196-196-196q-11-11-11-28t11-28q11-11 28-11t28 11l196 196 196-196q11-11 28-11t28 11q11 11 11 28t-11 28L536 576l196 196q11 11 11 28t-11 28q-11 11-28 11t-28-11L480 632Z"></path>
</svg>
</button>
</aside>
<main class="relative py-6 lg:gap-10 lg:py-8 xl:grid xl:grid-cols-[1fr_300px]">
<div class="w-full min-w-0 mx-auto">
<nav aria-label="breadcrumbs" class="flex items-center mb-4 space-x-1 text-sm text-muted-foreground">
<a class="overflow-hidden text-ellipsis whitespace-nowrap hover:text-foreground" href="../../index.html">
<span class="hidden md:inline">The Programming Reference Book</span>
<svg aria-label="Home" class="md:hidden" fill="currentColor" height="18" stroke="none" viewbox="0 96 960 960" width="18" xmlns="http://www.w3.org/2000/svg">
<path d="M240 856h120V616h240v240h120V496L480 316 240 496v360Zm-80 80V456l320-240 320 240v480H520V696h-80v240H160Zm320-350Z"></path>
</svg>
</a>
<div class="mr-1">.</div><a class="hover:text-foreground overflow-hidden text-ellipsis whitespace-nowrap" href="index.html">3.1 - Program Structure</a>
<div class="mr-1">.</div><span aria-current="page" class="font-medium text-foreground overflow-hidden text-ellipsis whitespace-nowrap">3.1.1 - Subsystems</span>
</nav>
<div id="content" role="main">
<section id="subsystems">
<h1>3.1.1 - Subsystems<a @click.prevent="window.navigator.clipboard.writeText($el.href); $el.setAttribute('data-tooltip', 'Copied!'); setTimeout(() =&gt; $el.setAttribute('data-tooltip', 'Copy link to this element'), 2000)" aria-label="Copy link to this element" class="headerlink" data-tooltip="Copy link to this element" href="#subsystems"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h1>
<p>Subsystems are an important part of code; they let us interface directly with
hardware on the robot, and they help split up large tasks by grouping them into
distinct groups of tasks per subsystem.</p>
<p>This page provides a general “best practices” list for subsystems.</p>
<section id="describe-state-categorically">
<h2>Describe state categorically<a @click.prevent="window.navigator.clipboard.writeText($el.href); $el.setAttribute('data-tooltip', 'Copied!'); setTimeout(() =&gt; $el.setAttribute('data-tooltip', 'Copy link to this element'), 2000)" aria-label="Copy link to this element" class="headerlink" data-tooltip="Copy link to this element" href="#describe-state-categorically" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#describe-state-categorically'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h2>
<p>Subsystems - like a lot of things in robot programming - have mutable state. It
becomes important to be able to share this state outside of the subsystem
itself to make decisions in the future. For example, a “manipulator” subsystem
would need to expose state, such as whether a gamepiece is present, in order
for the robot to act on this information later.</p>
<p>However, some methods of exposing state are better than others. One thing we
want to avoid is the <a class="reference external" href="https://en.wikipedia.org/wiki/XY_problem" rel="nofollow noopener" target="_blank">XY Problem<svg fill="currentColor" height="1em" stroke="none" viewbox="0 96 960 960" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M188 868q-11-11-11-28t11-28l436-436H400q-17 0-28.5-11.5T360 336q0-17 11.5-28.5T400 296h320q17 0 28.5 11.5T760 336v320q0 17-11.5 28.5T720 696q-17 0-28.5-11.5T680 656V432L244 868q-11 11-28 11t-28-11Z"></path></svg></a>,
where some <a class="reference internal" href="../../glossary.html#term-client"><span class="xref std std-term">client</span></a> (code external to the subsystem) asks for one value
(say, elevator height) when what they really want to know is something else
(whether the elevator is at setpoint).</p>
<p>Exposing state through some value <code class="docutils literal notranslate"><span class="pre">X</span></code> just so that the client can process it
into some value <code class="docutils literal notranslate"><span class="pre">Y</span></code> is a bad idea, because it puts too much trust in the
client to do the right thing here. It also violates rules of encapsulation if
we allow public access to physical information about the subsystem, such as an
elevator’s height or a shooter’s voltage draw.</p>
<p>All of this information is eventually going to be used to make a decision, so
it’s better to represent that with a categorical value (more on that word in
<a class="reference internal" href="3_1_4_state_theory.html"><span class="doc">3.1.4 - State, Theory</span></a>.</p>
<p>Generally tend towards descriptive, discrete types rather than continuous, raw
data.</p>
<p>Here’s some examples:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">getSpeed()</span></code> should be <code class="docutils literal notranslate"><span class="pre">isReady()</span></code> if it’s being compared against some
speed setpoint value.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">getMotorTemperature()</span></code> should be <code class="docutils literal notranslate"><span class="pre">isOkay()</span></code> if it’s being used to verify
that the subsystem is physically okay.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">getArmPosition()</span></code> should be <code class="docutils literal notranslate"><span class="pre">atSetpoint()</span></code> if it’s being used to see if
a subsystem has reached it’s setpoint.</p></li>
</ul>
<p>Notice how all of these examples require context - what are we using the value
for? Help clean up the client’s code by moving those checks that they
shouldn’t do into the subsystem itself.</p>
</section>
<section id="expose-triggers-not-booleans">
<h2>Expose <code class="docutils literal notranslate"><span class="pre">Trigger</span></code>s, not <code class="docutils literal notranslate"><span class="pre">boolean</span></code>s<a @click.prevent="window.navigator.clipboard.writeText($el.href); $el.setAttribute('data-tooltip', 'Copied!'); setTimeout(() =&gt; $el.setAttribute('data-tooltip', 'Copy link to this element'), 2000)" aria-label="Copy link to this element" class="headerlink" data-tooltip="Copy link to this element" href="#expose-triggers-not-booleans" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#expose-triggers-not-booleans'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h2>
<p>Consider this method in a <code class="docutils literal notranslate"><span class="pre">Manipulator</span></code> subsystem:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">hasPiece</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="line-2"><span class="w">  </span><span class="cm">/* snip */</span>
</span><span id="line-3"><span class="p">}</span>
</span></code></pre></div>
</div>
<p>This works fine, and is usable outside of our class. It doesn’t expose any
information about the subsystem besides what the user actually wants to know,
so it seems good. However, there’s no guarantee in code at compile time that
this value continues to be valid. Obviously, this is because such a statement
is false. Not having a piece can easily change to having a piece in the future,
and vice versa.</p>
<p>Instead, it’s recommended to use a <code class="docutils literal notranslate"><span class="pre">Trigger</span></code> object, which is itself a form
of a <code class="docutils literal notranslate"><span class="pre">BooleanSupplier</span></code>. This way, we know that the value from this method is
always correct, because it updates with the state of the subsystem.</p>
<p>We should change the method signature to this:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="kd">public</span><span class="w"> </span><span class="n">Trigger</span><span class="w"> </span><span class="nf">hasPiece</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
</span><span id="line-2"><span class="w">  </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Trigger</span><span class="p">(()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
</span><span id="line-3"><span class="w">    </span><span class="o">/*</span><span class="w"> </span><span class="n">snip</span>
</span><span id="line-4"><span class="w">  </span><span class="p">});</span>
</span><span id="line-5"><span class="p">}</span>
</span></code></pre></div>
</div>
<p>Now, our code returns a <code class="docutils literal notranslate"><span class="pre">Trigger</span></code> object which will <em>always</em> be valid, and is
significantly more easily usable. Fun fact: <code class="docutils literal notranslate"><span class="pre">Trigger</span></code> objects also act as
<code class="docutils literal notranslate"><span class="pre">BooleanSupplier</span></code>s, so they are <em>very</em> versatile.</p>
<p>Additionally, it’s more likely that the end user will want to use this object
<em>as</em> a <code class="docutils literal notranslate"><span class="pre">Trigger</span></code>, and exposing these as the return type for methods makes it
easier to access these.</p>
</section>
<section id="return-commands">
<h2>Return <code class="docutils literal notranslate"><span class="pre">Command</span></code>s<a @click.prevent="window.navigator.clipboard.writeText($el.href); $el.setAttribute('data-tooltip', 'Copied!'); setTimeout(() =&gt; $el.setAttribute('data-tooltip', 'Copy link to this element'), 2000)" aria-label="Copy link to this element" class="headerlink" data-tooltip="Copy link to this element" href="#return-commands" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#return-commands'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h2>
<p>Sometimes, programmers will expose public <code class="docutils literal notranslate"><span class="pre">void</span></code> methods, such as
<code class="docutils literal notranslate"><span class="pre">setStow()</span></code> or <code class="docutils literal notranslate"><span class="pre">startAction()</span></code>. However, these can be confusing and
difficult to work with. Here’s why:</p>
<ol class="arabic simple">
<li><p>These commands don’t finish instantly. Instead, they may only <em>set</em> a
desired state - they won’t wait to actually achieve said state. The user has
to then wait for the subsystem to finish the desired action, which can be
forgotten by programmers.</p></li>
<li><p>It’s up to the client to make even remotely complex actions. For example, to
intake a gamepiece with this method, the client is expected to call the
<code class="docutils literal notranslate"><span class="pre">startIntake()</span></code> method, wait for a piece, and then call <code class="docutils literal notranslate"><span class="pre">stopIntake()</span></code>.
If they forget a step, their command will not run.</p></li>
<li><p>This induces repetitive code. If two large commands require different
behavior for the most part, but have <em>one</em> subsystem do the same thing, then
the implementation for that action will have to be copied across multiple
files.</p></li>
</ol>
<p>Instead, it’s preferred to avoid exposing incomplete actions and instead
returning <code class="docutils literal notranslate"><span class="pre">Command</span></code> instances that do a whole action.</p>
<p>This helps separate basic subsystem level behavior from full robot behavior and
makes it easier to make new commands. This also ensures that if that behavior
is ran, the rules of command requirements are followed.</p>
</section>
<section id="use-enums-extensively">
<h2>Use enums extensively<a @click.prevent="window.navigator.clipboard.writeText($el.href); $el.setAttribute('data-tooltip', 'Copied!'); setTimeout(() =&gt; $el.setAttribute('data-tooltip', 'Copy link to this element'), 2000)" aria-label="Copy link to this element" class="headerlink" data-tooltip="Copy link to this element" href="#use-enums-extensively" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#use-enums-extensively'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h2>
<p>It’s rarely a good idea to allow a nearly-infinite set of inputs to a system.
If your elevator has a method <code class="docutils literal notranslate"><span class="pre">go(double</span> <span class="pre">position)</span></code> and returns a command
that sends the elevator to that height, you’re allowing all of the following
problems:</p>
<ul class="simple">
<li><p>Inputs outside a reasonable range could break the robot. Checking for those
is necessary here, but is verbose and can be incorrectly done.</p></li>
<li><p>Inputs that don’t actually make sense for the mechanism are also allowed
unchecked. There’s rarely an infinite number of positions for a system to be
in, which isn’t great.</p></li>
<li><p>It’s up to the client to make sure that the setpoints are valid, which
violates subsystem’s rules of isolated internals. The user shouldn’t have to
know what the correct mechanism position values are for a subsystem.</p></li>
</ul>
<p>All of these problems can be replaced with a simple enum in code. Enums that
represent possible subsystem states have the following advantages:</p>
<ul class="simple">
<li><p>Ensures a finite set of valid inputs. The user can’t just create a new enum
variant and apply that. The variants are fixed, and can be declared inside
the subsystem.</p></li>
<li><p>The user has a better idea of what these values mean. <code class="docutils literal notranslate"><span class="pre">Stow</span></code> is a better
term in code than <code class="docutils literal notranslate"><span class="pre">0.241</span></code> for an elevator’s position.</p></li>
<li><p>It’s no longer up to the end user to supply the physical values; instead,
that can be handled inside the subsystem.</p></li>
</ul>
<p>Enums are incredibly non-verbose in Java as well (for this use case). We can
construct enums with associated values like so:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="kd">public</span><span class="w"> </span><span class="kd">enum</span><span class="w"> </span><span class="n">ArmState</span><span class="w"> </span><span class="p">{</span>
</span><span id="line-2"><span class="w">  </span><span class="n">Stow</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
</span><span id="line-3"><span class="w">  </span><span class="n">Score</span><span class="p">(</span><span class="mf">0.2</span><span class="p">),</span>
</span><span id="line-4"><span class="w">  </span><span class="n">Reverse</span><span class="p">(</span><span class="o">-</span><span class="mf">0.11</span><span class="p">);</span>
</span><span id="line-5">
</span><span id="line-6"><span class="w">  </span><span class="kd">protected</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">position</span><span class="p">;</span>
</span><span id="line-7"><span class="w">  </span><span class="kd">private</span><span class="w"> </span><span class="nf">ArmState</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">position</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
</span><span id="line-8"><span class="w">    </span><span class="k">this</span><span class="p">.</span><span class="na">position</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">position</span><span class="p">;</span>
</span><span id="line-9"><span class="w">  </span><span class="p">}</span>
</span><span id="line-10"><span class="p">}</span>
</span></code></pre></div>
</div>
<p>With this code, clients (outside of the subsystem’s package) can still refer to
<code class="docutils literal notranslate"><span class="pre">ArmState.Stow</span></code>, but they cannot see the value of <code class="docutils literal notranslate"><span class="pre">position</span></code>. But the
subsystem can. The subsystem can see the <code class="docutils literal notranslate"><span class="pre">position</span></code> field of the state and
easily set that as the position reference internally.</p>
</section>
<section id="separate-hardware-logic-from-subsystem-logic">
<h2>Separate hardware logic from subsystem logic<a @click.prevent="window.navigator.clipboard.writeText($el.href); $el.setAttribute('data-tooltip', 'Copied!'); setTimeout(() =&gt; $el.setAttribute('data-tooltip', 'Copy link to this element'), 2000)" aria-label="Copy link to this element" class="headerlink" data-tooltip="Copy link to this element" href="#separate-hardware-logic-from-subsystem-logic" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#separate-hardware-logic-from-subsystem-logic'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h2>
<p>If subsystems are expected to expose subsystem-specific commands, <em>and</em> they
have to handle the hardware objects, this is too much responsibility. Instead,
we can use composition to create an “IO layer” as another layer of abstraction
between hardware and subsystem logic.</p>
<p>These “IO” classes could be simple classes that are just instantiated
internally and used to write to the hardware, but there are a few other
optimizations we can make to ensure that subsystems work well.</p>
<p>For the rest of this small section, we’ll look at an <code class="docutils literal notranslate"><span class="pre">Intake</span></code> subsystem.</p>
<section id="cache-state">
<h3>Cache State<a @click.prevent="window.navigator.clipboard.writeText($el.href); $el.setAttribute('data-tooltip', 'Copied!'); setTimeout(() =&gt; $el.setAttribute('data-tooltip', 'Copy link to this element'), 2000)" aria-label="Copy link to this element" class="headerlink" data-tooltip="Copy link to this element" href="#cache-state" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#cache-state'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h3>
<p>It’s helpful to have consistent state throughout one cycle of the robot. This
can be done by caching each value from the hardware (voltage, temperature,
sensor states, etc.) independently, but this leaves the opportunity for
forgetting to update one value.</p>
<p>Instead, we can create an “IO inputs” class that looks like this:</p>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-text">IntakeIOInputs.java</span><a @click.prevent="window.navigator.clipboard.writeText($el.href); $el.setAttribute('data-tooltip', 'Copied!'); setTimeout(() =&gt; $el.setAttribute('data-tooltip', 'Copy link to this element'), 2000)" aria-label="Copy link to this element" class="headerlink" data-tooltip="Copy link to this element" href="#id1"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></div>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">IntakeIOInputs</span><span class="w"> </span><span class="p">{</span>
</span><span id="line-2"><span class="w">  </span><span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="n">coralSensorTriggered</span><span class="p">;</span>
</span><span id="line-3"><span class="w">  </span><span class="kd">public</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">pivotPosition</span><span class="p">;</span>
</span><span id="line-4"><span class="w">  </span><span class="kd">public</span><span class="w"> </span><span class="kt">double</span><span class="w"> </span><span class="n">intakeVoltage</span><span class="p">;</span>
</span><span id="line-5"><span class="p">}</span>
</span></code></pre></div>
</div>
</div>
<p>Now, we can also define a method <code class="docutils literal notranslate"><span class="pre">updateInputs(IntakeIOInputs</span> <span class="pre">inputs)</span></code> method
on the IO class, which updates the values in the entire inputs object, which
can be called once in the subsystem’s <code class="docutils literal notranslate"><span class="pre">periodic()</span></code> method. This ensures a
consistent state across an entire loop, which is good.</p>
</section>
<section id="use-interfaces">
<h3>Use interfaces<a @click.prevent="window.navigator.clipboard.writeText($el.href); $el.setAttribute('data-tooltip', 'Copied!'); setTimeout(() =&gt; $el.setAttribute('data-tooltip', 'Copy link to this element'), 2000)" aria-label="Copy link to this element" class="headerlink" data-tooltip="Copy link to this element" href="#use-interfaces" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#use-interfaces'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h3>
<p>We <em>could</em> create an <code class="docutils literal notranslate"><span class="pre">IntakeIOHardware</span></code> class, which would handle all of our
IO operations with hardware. However, let’s consider more advanced features in
the long run - mainly simulation. If we want to simulate the robot, it’s best
to have a strict division between the robot’s hardware code and it’s associated
code in simulation.</p>
<p>Instead, let’s create an <code class="docutils literal notranslate"><span class="pre">IntakeIO</span></code> interface, which <code class="docutils literal notranslate"><span class="pre">IntakeIOHardware</span></code>
implements. Here’s what the interface may look like in code:</p>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-text">IntakeIO.java</span><a @click.prevent="window.navigator.clipboard.writeText($el.href); $el.setAttribute('data-tooltip', 'Copied!'); setTimeout(() =&gt; $el.setAttribute('data-tooltip', 'Copy link to this element'), 2000)" aria-label="Copy link to this element" class="headerlink" data-tooltip="Copy link to this element" href="#id2"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></div>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="kd">public</span><span class="w"> </span><span class="kd">interface</span> <span class="nc">IntakeIO</span><span class="w"> </span><span class="p">{</span>
</span><span id="line-2"><span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="nf">setRollerVoltage</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">voltage</span><span class="p">);</span>
</span><span id="line-3"><span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="nf">setPivotPosition</span><span class="p">(</span><span class="kt">double</span><span class="w"> </span><span class="n">position</span><span class="p">);</span>
</span><span id="line-4">
</span><span id="line-5"><span class="w">  </span><span class="kt">void</span><span class="w"> </span><span class="nf">updateInputs</span><span class="p">(</span><span class="n">IntakeIOInputs</span><span class="w"> </span><span class="n">inputs</span><span class="p">);</span>
</span><span id="line-6"><span class="p">}</span>
</span></code></pre></div>
</div>
</div>
<p>Now, instead of storing the io layer as <code class="docutils literal notranslate"><span class="pre">IntakeIOHardware</span></code>, we can simply
update <code class="docutils literal notranslate"><span class="pre">IntakeIOHardware</span></code> to implement <code class="docutils literal notranslate"><span class="pre">IntakeIO</span></code> and store the IO object
as an <code class="docutils literal notranslate"><span class="pre">IntakeIO</span></code> object, allowing for other classes that also implement
<code class="docutils literal notranslate"><span class="pre">IntakeIO</span></code>. We can create a separate class, <code class="docutils literal notranslate"><span class="pre">IntakeIOSim</span></code> which has all the
same methods, but can vary in implementation, making simulations easier to
change.</p>
<p>We can also create more classes that implement <code class="docutils literal notranslate"><span class="pre">IntakeIO</span></code> for unit testing
purposes if we so desire.</p>
</section>
</section>
<section id="example-subsystem-elevator">
<h2>Example subsystem: Elevator<a @click.prevent="window.navigator.clipboard.writeText($el.href); $el.setAttribute('data-tooltip', 'Copied!'); setTimeout(() =&gt; $el.setAttribute('data-tooltip', 'Copy link to this element'), 2000)" aria-label="Copy link to this element" class="headerlink" data-tooltip="Copy link to this element" href="#example-subsystem-elevator" x-intersect.margin.0%.0%.-70%.0%="activeSection = '#example-subsystem-elevator'"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></h2>
<p>Here is an example elevator subsystem, copied from team 3414’s 2025 REEFSCAPE
program code.</p>
<p>Firstly, the subsystem’s IO interface is declared. This is the class that the
subsystem class itself will use to communicate with the hardware.</p>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-text">ElevatorIO.java</span><a @click.prevent="window.navigator.clipboard.writeText($el.href); $el.setAttribute('data-tooltip', 'Copied!'); setTimeout(() =&gt; $el.setAttribute('data-tooltip', 'Copy link to this element'), 2000)" aria-label="Copy link to this element" class="headerlink" data-tooltip="Copy link to this element" href="#id3"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="linenos"> 1</span><span class="n">package</span> <span class="n">frc</span><span class="o">.</span><span class="n">robot</span><span class="o">.</span><span class="n">subsystems</span><span class="o">.</span><span class="n">elevator</span><span class="p">;</span>
</span><span id="line-2"><span class="linenos"> 2</span>
</span><span id="line-3"><span class="linenos"> 3</span><span class="n">public</span> <span class="n">interface</span> <span class="n">ElevatorIO</span> <span class="p">{</span>
</span><span id="line-4"><span class="linenos"> 4</span>  <span class="n">void</span> <span class="n">updateInputs</span><span class="p">(</span><span class="n">ElevatorIOInputs</span> <span class="n">inputs</span><span class="p">);</span>
</span><span id="line-5"><span class="linenos"> 5</span>
</span><span id="line-6"><span class="linenos"> 6</span>  <span class="n">public</span> <span class="k">class</span><span class="w"> </span><span class="nc">ElevatorIOInputs</span> <span class="p">{</span>
</span><span id="line-7"><span class="linenos"> 7</span>    <span class="n">public</span> <span class="n">boolean</span> <span class="n">leftMotorConnected</span> <span class="o">=</span> <span class="n">true</span><span class="p">;</span>
</span><span id="line-8"><span class="linenos"> 8</span>    <span class="n">public</span> <span class="n">boolean</span> <span class="n">rightMotorConnected</span> <span class="o">=</span> <span class="n">true</span><span class="p">;</span>
</span><span id="line-9"><span class="linenos"> 9</span>    <span class="n">public</span> <span class="n">double</span> <span class="n">leftVoltage</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
</span><span id="line-10"><span class="linenos">10</span>    <span class="n">public</span> <span class="n">double</span> <span class="n">rightVoltage</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
</span><span id="line-11"><span class="linenos">11</span>    <span class="n">public</span> <span class="n">double</span> <span class="n">leftCurrent</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
</span><span id="line-12"><span class="linenos">12</span>    <span class="n">public</span> <span class="n">double</span> <span class="n">rightCurrent</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
</span><span id="line-13"><span class="linenos">13</span>    <span class="n">public</span> <span class="n">double</span> <span class="n">leftTemp</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
</span><span id="line-14"><span class="linenos">14</span>    <span class="n">public</span> <span class="n">double</span> <span class="n">rightTemp</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
</span><span id="line-15"><span class="linenos">15</span>    <span class="n">public</span> <span class="n">double</span> <span class="n">leftVelocityRPS</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
</span><span id="line-16"><span class="linenos">16</span>    <span class="n">public</span> <span class="n">double</span> <span class="n">rightVelocityRPS</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
</span><span id="line-17"><span class="linenos">17</span>    <span class="n">public</span> <span class="n">double</span> <span class="n">leftPosition</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
</span><span id="line-18"><span class="linenos">18</span>    <span class="n">public</span> <span class="n">double</span> <span class="n">rightPosition</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
</span><span id="line-19"><span class="linenos">19</span>    <span class="n">public</span> <span class="n">double</span> <span class="n">position</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
</span><span id="line-20"><span class="linenos">20</span>    <span class="n">public</span> <span class="n">double</span> <span class="n">reference</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
</span><span id="line-21"><span class="linenos">21</span>    <span class="n">public</span> <span class="n">boolean</span> <span class="n">zeroCANrangeConnected</span> <span class="o">=</span> <span class="n">true</span><span class="p">;</span>
</span><span id="line-22"><span class="linenos">22</span>    <span class="n">public</span> <span class="n">boolean</span> <span class="n">zeroCANrangeDetected</span> <span class="o">=</span> <span class="n">false</span><span class="p">;</span>
</span><span id="line-23"><span class="linenos">23</span>    <span class="n">public</span> <span class="n">double</span> <span class="n">zeroCANrangeDistance</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
</span><span id="line-24"><span class="linenos">24</span>    <span class="n">public</span> <span class="n">double</span> <span class="n">zeroCANrangeStrength</span> <span class="o">=</span> <span class="mf">0.0</span><span class="p">;</span>
</span><span id="line-25"><span class="linenos">25</span>  <span class="p">}</span>
</span><span id="line-26"><span class="linenos">26</span>
</span><span id="line-27"><span class="linenos">27</span>  <span class="o">/**</span>
</span><span id="line-28"><span class="linenos">28</span>   <span class="o">*</span> <span class="n">Sets</span> <span class="n">the</span> <span class="n">elevator</span><span class="s1">'s position reference to the desired position in mechanical</span>
</span><span id="line-29"><span class="linenos">29</span>   <span class="o">*</span> <span class="n">units</span><span class="o">.</span>
</span><span id="line-30"><span class="linenos">30</span>   <span class="o">*/</span>
</span><span id="line-31"><span class="linenos">31</span>  <span class="n">void</span> <span class="n">setPosition</span><span class="p">(</span><span class="n">double</span> <span class="n">position</span><span class="p">);</span>
</span><span id="line-32"><span class="linenos">32</span>
</span><span id="line-33"><span class="linenos">33</span>  <span class="o">/**</span>
</span><span id="line-34"><span class="linenos">34</span>   <span class="o">*</span> <span class="n">Sets</span> <span class="n">the</span> <span class="n">elevator</span><span class="s1">'s applied voltage to the desired voltage.</span>
</span><span id="line-35"><span class="linenos">35</span>   <span class="o">*/</span>
</span><span id="line-36"><span class="linenos">36</span>  <span class="n">void</span> <span class="n">setVoltage</span><span class="p">(</span><span class="n">double</span> <span class="n">voltage</span><span class="p">);</span>
</span><span id="line-37"><span class="linenos">37</span>
</span><span id="line-38"><span class="linenos">38</span>  <span class="o">/**</span>
</span><span id="line-39"><span class="linenos">39</span>   <span class="o">*</span> <span class="n">Disables</span> <span class="n">the</span> <span class="n">elevator</span><span class="s1">'s soft limits. This is useful when re-zeroing the</span>
</span><span id="line-40"><span class="linenos">40</span>   <span class="o">*</span> <span class="n">elevator</span> <span class="ow">and</span> <span class="n">the</span> <span class="n">soft</span> <span class="n">limits</span> <span class="n">can</span><span class="s1">'t be trusted because the position may be</span>
</span><span id="line-41"><span class="linenos">41</span>   <span class="o">*</span> <span class="n">incorrect</span><span class="o">.</span>
</span><span id="line-42"><span class="linenos">42</span>   <span class="o">*/</span>
</span><span id="line-43"><span class="linenos">43</span>  <span class="n">void</span> <span class="n">disableLimits</span><span class="p">();</span>
</span><span id="line-44"><span class="linenos">44</span>
</span><span id="line-45"><span class="linenos">45</span>  <span class="o">/**</span>
</span><span id="line-46"><span class="linenos">46</span>   <span class="o">*</span> <span class="n">Enables</span> <span class="n">the</span> <span class="n">soft</span> <span class="n">limits</span> <span class="n">of</span> <span class="n">the</span> <span class="n">elevator</span>
</span><span id="line-47"><span class="linenos">47</span>   <span class="o">*/</span>
</span><span id="line-48"><span class="linenos">48</span>  <span class="n">void</span> <span class="n">enableLimits</span><span class="p">();</span>
</span><span id="line-49"><span class="linenos">49</span>
</span><span id="line-50"><span class="linenos">50</span>  <span class="o">/**</span>
</span><span id="line-51"><span class="linenos">51</span>   <span class="o">*</span> <span class="n">Resets</span> <span class="n">the</span> <span class="n">elevator</span><span class="s1">'s encoders to accept the current position as zero.</span>
</span><span id="line-52"><span class="linenos">52</span>   <span class="o">*/</span>
</span><span id="line-53"><span class="linenos">53</span>  <span class="n">void</span> <span class="n">calibrateZero</span><span class="p">();</span>
</span><span id="line-54"><span class="linenos">54</span><span class="p">}</span>
</span></code></pre></div>
</div>
</div>
<p>Here, we see that we not only declare the <code class="docutils literal notranslate"><span class="pre">ElevatorIO</span></code> interface, but we also
define the <code class="docutils literal notranslate"><span class="pre">ElevatorIOInputs</span></code> class. For a real robot, there are a <em>lot</em> of
inputs, so we list each of them here. We also define several other low-level
methods, such as <code class="docutils literal notranslate"><span class="pre">setVoltage()</span></code> and <code class="docutils literal notranslate"><span class="pre">setPosition()</span></code>, and some more
features.</p>
<p>We can now take a look at the hardware implementation of the <code class="docutils literal notranslate"><span class="pre">ElevatorIO</span></code>
interface:</p>
<div class="literal-block-wrapper docutils container" id="id4">
<div class="code-block-caption"><span class="caption-text">ElevatorIOHardware.java</span><a @click.prevent="window.navigator.clipboard.writeText($el.href); $el.setAttribute('data-tooltip', 'Copied!'); setTimeout(() =&gt; $el.setAttribute('data-tooltip', 'Copy link to this element'), 2000)" aria-label="Copy link to this element" class="headerlink" data-tooltip="Copy link to this element" href="#id4"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="linenos">  1</span><span class="n">package</span> <span class="n">frc</span><span class="o">.</span><span class="n">robot</span><span class="o">.</span><span class="n">subsystems</span><span class="o">.</span><span class="n">elevator</span><span class="p">;</span>
</span><span id="line-2"><span class="linenos">  2</span>
</span><span id="line-3"><span class="linenos">  3</span><span class="kn">import</span><span class="w"> </span><span class="nn">com.ctre.phoenix6.BaseStatusSignal</span><span class="p">;</span>
</span><span id="line-4"><span class="linenos">  4</span><span class="o">/*</span> <span class="n">snip</span> <span class="o">*/</span>
</span><span id="line-5"><span class="linenos">  5</span>
</span><span id="line-6"><span class="linenos">  6</span><span class="n">public</span> <span class="k">class</span><span class="w"> </span><span class="nc">ElevatorIOHardware</span> <span class="n">implements</span> <span class="n">ElevatorIO</span> <span class="p">{</span>
</span><span id="line-7"><span class="linenos">  7</span>  <span class="n">private</span> <span class="n">final</span> <span class="n">TalonFX</span> <span class="n">leftMotor</span><span class="p">;</span>
</span><span id="line-8"><span class="linenos">  8</span>  <span class="n">private</span> <span class="n">final</span> <span class="n">TalonFX</span> <span class="n">rightMotor</span><span class="p">;</span>
</span><span id="line-9"><span class="linenos">  9</span>
</span><span id="line-10"><span class="linenos"> 10</span>  <span class="n">private</span> <span class="n">final</span> <span class="n">CANrange</span> <span class="n">CANrange</span><span class="p">;</span>
</span><span id="line-11"><span class="linenos"> 11</span>  <span class="n">private</span> <span class="n">final</span> <span class="n">SoftwareLimitSwitchConfigs</span> <span class="n">noLimits</span> <span class="o">=</span> <span class="n">new</span> <span class="n">SoftwareLimitSwitchConfigs</span><span class="p">()</span>
</span><span id="line-12"><span class="linenos"> 12</span>      <span class="o">.</span><span class="n">withForwardSoftLimitEnable</span><span class="p">(</span><span class="n">false</span><span class="p">)</span>
</span><span id="line-13"><span class="linenos"> 13</span>      <span class="o">.</span><span class="n">withReverseSoftLimitEnable</span><span class="p">(</span><span class="n">false</span><span class="p">);</span>
</span><span id="line-14"><span class="linenos"> 14</span>
</span><span id="line-15"><span class="linenos"> 15</span>  <span class="n">private</span> <span class="n">final</span> <span class="n">DynamicMotionMagicVoltage</span> <span class="n">control</span><span class="p">;</span>
</span><span id="line-16"><span class="linenos"> 16</span>
</span><span id="line-17"><span class="linenos"> 17</span>  <span class="n">private</span> <span class="n">double</span> <span class="n">reference</span> <span class="o">=</span> <span class="n">Double</span><span class="o">.</span><span class="n">NaN</span><span class="p">;</span>
</span><span id="line-18"><span class="linenos"> 18</span>
</span><span id="line-19"><span class="linenos"> 19</span>  <span class="n">private</span> <span class="n">final</span> <span class="n">StatusSignal</span><span class="o">&lt;</span><span class="n">Voltage</span><span class="o">&gt;</span> <span class="n">leftVoltageSignal</span><span class="p">;</span>
</span><span id="line-20"><span class="linenos"> 20</span>  <span class="n">private</span> <span class="n">final</span> <span class="n">StatusSignal</span><span class="o">&lt;</span><span class="n">Voltage</span><span class="o">&gt;</span> <span class="n">rightVoltageSignal</span><span class="p">;</span>
</span><span id="line-21"><span class="linenos"> 21</span>  <span class="n">private</span> <span class="n">final</span> <span class="n">StatusSignal</span><span class="o">&lt;</span><span class="n">Current</span><span class="o">&gt;</span> <span class="n">leftCurrentSignal</span><span class="p">;</span>
</span><span id="line-22"><span class="linenos"> 22</span>  <span class="n">private</span> <span class="n">final</span> <span class="n">StatusSignal</span><span class="o">&lt;</span><span class="n">Current</span><span class="o">&gt;</span> <span class="n">rightCurrentSignal</span><span class="p">;</span>
</span><span id="line-23"><span class="linenos"> 23</span>  <span class="n">private</span> <span class="n">final</span> <span class="n">StatusSignal</span><span class="o">&lt;</span><span class="n">Temperature</span><span class="o">&gt;</span> <span class="n">leftTempSignal</span><span class="p">;</span>
</span><span id="line-24"><span class="linenos"> 24</span>  <span class="n">private</span> <span class="n">final</span> <span class="n">StatusSignal</span><span class="o">&lt;</span><span class="n">Temperature</span><span class="o">&gt;</span> <span class="n">rightTempSignal</span><span class="p">;</span>
</span><span id="line-25"><span class="linenos"> 25</span>  <span class="n">private</span> <span class="n">final</span> <span class="n">StatusSignal</span><span class="o">&lt;</span><span class="n">AngularVelocity</span><span class="o">&gt;</span> <span class="n">leftVelocitySignal</span><span class="p">;</span>
</span><span id="line-26"><span class="linenos"> 26</span>  <span class="n">private</span> <span class="n">final</span> <span class="n">StatusSignal</span><span class="o">&lt;</span><span class="n">AngularVelocity</span><span class="o">&gt;</span> <span class="n">rightVelocitySignal</span><span class="p">;</span>
</span><span id="line-27"><span class="linenos"> 27</span>  <span class="n">private</span> <span class="n">final</span> <span class="n">StatusSignal</span><span class="o">&lt;</span><span class="n">Angle</span><span class="o">&gt;</span> <span class="n">leftPositionSignal</span><span class="p">;</span>
</span><span id="line-28"><span class="linenos"> 28</span>  <span class="n">private</span> <span class="n">final</span> <span class="n">StatusSignal</span><span class="o">&lt;</span><span class="n">Angle</span><span class="o">&gt;</span> <span class="n">rightPositionSignal</span><span class="p">;</span>
</span><span id="line-29"><span class="linenos"> 29</span>
</span><span id="line-30"><span class="linenos"> 30</span>  <span class="n">private</span> <span class="n">final</span> <span class="n">StatusSignal</span><span class="o">&lt;</span><span class="n">Distance</span><span class="o">&gt;</span> <span class="n">CANrangeDistanceSignal</span><span class="p">;</span>
</span><span id="line-31"><span class="linenos"> 31</span>  <span class="n">private</span> <span class="n">final</span> <span class="n">StatusSignal</span><span class="o">&lt;</span><span class="n">Boolean</span><span class="o">&gt;</span> <span class="n">CANrangeDetectedSignal</span><span class="p">;</span>
</span><span id="line-32"><span class="linenos"> 32</span>  <span class="n">private</span> <span class="n">final</span> <span class="n">StatusSignal</span><span class="o">&lt;</span><span class="n">Double</span><span class="o">&gt;</span> <span class="n">CANrangeStrengthSignal</span><span class="p">;</span>
</span><span id="line-33"><span class="linenos"> 33</span>
</span><span id="line-34"><span class="linenos"> 34</span>  <span class="n">public</span> <span class="n">ElevatorIOHardware</span><span class="p">()</span> <span class="p">{</span>
</span><span id="line-35"><span class="linenos"> 35</span>    <span class="n">rightMotor</span> <span class="o">=</span> <span class="n">new</span> <span class="n">TalonFX</span><span class="p">(</span><span class="n">ElevatorConstants</span><span class="o">.</span><span class="n">kRightMotorID</span><span class="p">,</span> <span class="s2">"*"</span><span class="p">);</span>
</span><span id="line-36"><span class="linenos"> 36</span>    <span class="n">leftMotor</span> <span class="o">=</span> <span class="n">new</span> <span class="n">TalonFX</span><span class="p">(</span><span class="n">ElevatorConstants</span><span class="o">.</span><span class="n">kLeftMotorID</span><span class="p">,</span> <span class="s2">"*"</span><span class="p">);</span>
</span><span id="line-37"><span class="linenos"> 37</span>    <span class="n">rightMotor</span><span class="o">.</span><span class="n">getConfigurator</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">ElevatorConstants</span><span class="o">.</span><span class="n">kMotorConfig</span><span class="p">);</span>
</span><span id="line-38"><span class="linenos"> 38</span>    <span class="n">leftMotor</span><span class="o">.</span><span class="n">getConfigurator</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">ElevatorConstants</span><span class="o">.</span><span class="n">kMotorConfig</span><span class="p">);</span>
</span><span id="line-39"><span class="linenos"> 39</span>    <span class="n">leftMotor</span>
</span><span id="line-40"><span class="linenos"> 40</span>        <span class="o">.</span><span class="n">setControl</span><span class="p">(</span><span class="n">new</span> <span class="n">Follower</span><span class="p">(</span><span class="n">ElevatorConstants</span><span class="o">.</span><span class="n">kRightMotorID</span><span class="p">,</span> <span class="n">ElevatorConstants</span><span class="o">.</span><span class="n">kInvertLeft</span><span class="p">));</span>
</span><span id="line-41"><span class="linenos"> 41</span>    <span class="n">rightMotor</span><span class="o">.</span><span class="n">setPosition</span><span class="p">(</span><span class="mf">0.0</span><span class="p">);</span>
</span><span id="line-42"><span class="linenos"> 42</span>    <span class="n">leftMotor</span><span class="o">.</span><span class="n">setPosition</span><span class="p">(</span><span class="mf">0.0</span><span class="p">);</span>
</span><span id="line-43"><span class="linenos"> 43</span>
</span><span id="line-44"><span class="linenos"> 44</span>    <span class="n">CANrange</span> <span class="o">=</span> <span class="n">new</span> <span class="n">CANrange</span><span class="p">(</span><span class="n">ElevatorConstants</span><span class="o">.</span><span class="n">kCANrangeID</span><span class="p">);</span>
</span><span id="line-45"><span class="linenos"> 45</span>    <span class="n">CANrange</span><span class="o">.</span><span class="n">getConfigurator</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">ElevatorConstants</span><span class="o">.</span><span class="n">kCANrangeConfig</span><span class="p">);</span>
</span><span id="line-46"><span class="linenos"> 46</span>
</span><span id="line-47"><span class="linenos"> 47</span>    <span class="n">control</span> <span class="o">=</span> <span class="n">new</span> <span class="n">DynamicMotionMagicVoltage</span><span class="p">(</span>
</span><span id="line-48"><span class="linenos"> 48</span>        <span class="mi">0</span><span class="p">,</span> <span class="o">//</span> <span class="n">no</span> <span class="n">position</span> <span class="n">setpoint</span> <span class="n">yet</span>
</span><span id="line-49"><span class="linenos"> 49</span>        <span class="n">ElevatorConstants</span><span class="o">.</span><span class="n">kMaxSpeed</span><span class="p">,</span>
</span><span id="line-50"><span class="linenos"> 50</span>        <span class="n">ElevatorConstants</span><span class="o">.</span><span class="n">kMaxAcceleration</span><span class="p">,</span>
</span><span id="line-51"><span class="linenos"> 51</span>        <span class="n">ElevatorConstants</span><span class="o">.</span><span class="n">kMaxJerk</span><span class="p">);</span>
</span><span id="line-52"><span class="linenos"> 52</span>
</span><span id="line-53"><span class="linenos"> 53</span>    <span class="n">leftVoltageSignal</span> <span class="o">=</span> <span class="n">leftMotor</span><span class="o">.</span><span class="n">getMotorVoltage</span><span class="p">();</span>
</span><span id="line-54"><span class="linenos"> 54</span>    <span class="n">rightVoltageSignal</span> <span class="o">=</span> <span class="n">rightMotor</span><span class="o">.</span><span class="n">getMotorVoltage</span><span class="p">();</span>
</span><span id="line-55"><span class="linenos"> 55</span>    <span class="n">leftCurrentSignal</span> <span class="o">=</span> <span class="n">leftMotor</span><span class="o">.</span><span class="n">getSupplyCurrent</span><span class="p">();</span>
</span><span id="line-56"><span class="linenos"> 56</span>    <span class="n">rightCurrentSignal</span> <span class="o">=</span> <span class="n">rightMotor</span><span class="o">.</span><span class="n">getSupplyCurrent</span><span class="p">();</span>
</span><span id="line-57"><span class="linenos"> 57</span>    <span class="n">leftTempSignal</span> <span class="o">=</span> <span class="n">leftMotor</span><span class="o">.</span><span class="n">getDeviceTemp</span><span class="p">();</span>
</span><span id="line-58"><span class="linenos"> 58</span>    <span class="n">rightTempSignal</span> <span class="o">=</span> <span class="n">rightMotor</span><span class="o">.</span><span class="n">getDeviceTemp</span><span class="p">();</span>
</span><span id="line-59"><span class="linenos"> 59</span>    <span class="n">leftVelocitySignal</span> <span class="o">=</span> <span class="n">leftMotor</span><span class="o">.</span><span class="n">getVelocity</span><span class="p">();</span>
</span><span id="line-60"><span class="linenos"> 60</span>    <span class="n">rightVelocitySignal</span> <span class="o">=</span> <span class="n">rightMotor</span><span class="o">.</span><span class="n">getVelocity</span><span class="p">();</span>
</span><span id="line-61"><span class="linenos"> 61</span>    <span class="n">leftPositionSignal</span> <span class="o">=</span> <span class="n">leftMotor</span><span class="o">.</span><span class="n">getPosition</span><span class="p">();</span>
</span><span id="line-62"><span class="linenos"> 62</span>    <span class="n">rightPositionSignal</span> <span class="o">=</span> <span class="n">rightMotor</span><span class="o">.</span><span class="n">getPosition</span><span class="p">();</span>
</span><span id="line-63"><span class="linenos"> 63</span>
</span><span id="line-64"><span class="linenos"> 64</span>    <span class="n">CANrangeDetectedSignal</span> <span class="o">=</span> <span class="n">CANrange</span><span class="o">.</span><span class="n">getIsDetected</span><span class="p">();</span>
</span><span id="line-65"><span class="linenos"> 65</span>    <span class="n">CANrangeDistanceSignal</span> <span class="o">=</span> <span class="n">CANrange</span><span class="o">.</span><span class="n">getDistance</span><span class="p">();</span>
</span><span id="line-66"><span class="linenos"> 66</span>    <span class="n">CANrangeStrengthSignal</span> <span class="o">=</span> <span class="n">CANrange</span><span class="o">.</span><span class="n">getSignalStrength</span><span class="p">();</span>
</span><span id="line-67"><span class="linenos"> 67</span>
</span><span id="line-68"><span class="linenos"> 68</span>    <span class="n">StatusSignalUtil</span><span class="o">.</span><span class="n">registerCANivoreSignals</span><span class="p">(</span>
</span><span id="line-69"><span class="linenos"> 69</span>        <span class="n">leftVoltageSignal</span><span class="p">,</span>
</span><span id="line-70"><span class="linenos"> 70</span>        <span class="n">rightVoltageSignal</span><span class="p">,</span>
</span><span id="line-71"><span class="linenos"> 71</span>        <span class="n">leftCurrentSignal</span><span class="p">,</span>
</span><span id="line-72"><span class="linenos"> 72</span>        <span class="n">rightCurrentSignal</span><span class="p">,</span>
</span><span id="line-73"><span class="linenos"> 73</span>        <span class="n">leftTempSignal</span><span class="p">,</span>
</span><span id="line-74"><span class="linenos"> 74</span>        <span class="n">rightTempSignal</span><span class="p">,</span>
</span><span id="line-75"><span class="linenos"> 75</span>        <span class="n">leftVelocitySignal</span><span class="p">,</span>
</span><span id="line-76"><span class="linenos"> 76</span>        <span class="n">rightVelocitySignal</span><span class="p">,</span>
</span><span id="line-77"><span class="linenos"> 77</span>        <span class="n">leftPositionSignal</span><span class="p">,</span>
</span><span id="line-78"><span class="linenos"> 78</span>        <span class="n">rightPositionSignal</span><span class="p">);</span>
</span><span id="line-79"><span class="linenos"> 79</span>    <span class="n">StatusSignalUtil</span><span class="o">.</span><span class="n">registerRioSignals</span><span class="p">(</span>
</span><span id="line-80"><span class="linenos"> 80</span>        <span class="n">CANrangeDetectedSignal</span><span class="p">,</span>
</span><span id="line-81"><span class="linenos"> 81</span>        <span class="n">CANrangeDistanceSignal</span><span class="p">,</span>
</span><span id="line-82"><span class="linenos"> 82</span>        <span class="n">CANrangeStrengthSignal</span><span class="p">);</span>
</span><span id="line-83"><span class="linenos"> 83</span>  <span class="p">}</span>
</span><span id="line-84"><span class="linenos"> 84</span>
</span><span id="line-85"><span class="linenos"> 85</span>  <span class="n">public</span> <span class="n">void</span> <span class="n">updateInputs</span><span class="p">(</span><span class="n">ElevatorIOInputs</span> <span class="n">inputs</span><span class="p">)</span> <span class="p">{</span>
</span><span id="line-86"><span class="linenos"> 86</span>    <span class="n">inputs</span><span class="o">.</span><span class="n">leftMotorConnected</span> <span class="o">=</span> <span class="n">BaseStatusSignal</span><span class="o">.</span><span class="n">isAllGood</span><span class="p">(</span>
</span><span id="line-87"><span class="linenos"> 87</span>        <span class="n">leftVoltageSignal</span><span class="p">,</span>
</span><span id="line-88"><span class="linenos"> 88</span>        <span class="n">leftCurrentSignal</span><span class="p">,</span>
</span><span id="line-89"><span class="linenos"> 89</span>        <span class="n">leftTempSignal</span><span class="p">,</span>
</span><span id="line-90"><span class="linenos"> 90</span>        <span class="n">leftVelocitySignal</span><span class="p">,</span>
</span><span id="line-91"><span class="linenos"> 91</span>        <span class="n">leftPositionSignal</span><span class="p">);</span>
</span><span id="line-92"><span class="linenos"> 92</span>    <span class="n">inputs</span><span class="o">.</span><span class="n">rightMotorConnected</span> <span class="o">=</span> <span class="n">BaseStatusSignal</span><span class="o">.</span><span class="n">isAllGood</span><span class="p">(</span>
</span><span id="line-93"><span class="linenos"> 93</span>        <span class="n">rightVoltageSignal</span><span class="p">,</span>
</span><span id="line-94"><span class="linenos"> 94</span>        <span class="n">rightCurrentSignal</span><span class="p">,</span>
</span><span id="line-95"><span class="linenos"> 95</span>        <span class="n">rightTempSignal</span><span class="p">,</span>
</span><span id="line-96"><span class="linenos"> 96</span>        <span class="n">rightVelocitySignal</span><span class="p">,</span>
</span><span id="line-97"><span class="linenos"> 97</span>        <span class="n">rightPositionSignal</span><span class="p">);</span>
</span><span id="line-98"><span class="linenos"> 98</span>    <span class="n">inputs</span><span class="o">.</span><span class="n">leftVoltage</span> <span class="o">=</span> <span class="n">leftVoltageSignal</span><span class="o">.</span><span class="n">getValueAsDouble</span><span class="p">();</span>
</span><span id="line-99"><span class="linenos"> 99</span>    <span class="n">inputs</span><span class="o">.</span><span class="n">rightVoltage</span> <span class="o">=</span> <span class="n">rightVoltageSignal</span><span class="o">.</span><span class="n">getValueAsDouble</span><span class="p">();</span>
</span><span id="line-100"><span class="linenos">100</span>    <span class="n">inputs</span><span class="o">.</span><span class="n">leftCurrent</span> <span class="o">=</span> <span class="n">leftCurrentSignal</span><span class="o">.</span><span class="n">getValueAsDouble</span><span class="p">();</span>
</span><span id="line-101"><span class="linenos">101</span>    <span class="n">inputs</span><span class="o">.</span><span class="n">rightCurrent</span> <span class="o">=</span> <span class="n">rightCurrentSignal</span><span class="o">.</span><span class="n">getValueAsDouble</span><span class="p">();</span>
</span><span id="line-102"><span class="linenos">102</span>    <span class="n">inputs</span><span class="o">.</span><span class="n">leftTemp</span> <span class="o">=</span> <span class="n">leftTempSignal</span><span class="o">.</span><span class="n">getValueAsDouble</span><span class="p">();</span>
</span><span id="line-103"><span class="linenos">103</span>    <span class="n">inputs</span><span class="o">.</span><span class="n">rightTemp</span> <span class="o">=</span> <span class="n">rightTempSignal</span><span class="o">.</span><span class="n">getValueAsDouble</span><span class="p">();</span>
</span><span id="line-104"><span class="linenos">104</span>    <span class="n">inputs</span><span class="o">.</span><span class="n">leftVelocityRPS</span> <span class="o">=</span> <span class="n">leftVelocitySignal</span><span class="o">.</span><span class="n">getValueAsDouble</span><span class="p">();</span>
</span><span id="line-105"><span class="linenos">105</span>    <span class="n">inputs</span><span class="o">.</span><span class="n">rightVelocityRPS</span> <span class="o">=</span> <span class="n">rightVelocitySignal</span><span class="o">.</span><span class="n">getValueAsDouble</span><span class="p">();</span>
</span><span id="line-106"><span class="linenos">106</span>    <span class="n">inputs</span><span class="o">.</span><span class="n">leftPosition</span> <span class="o">=</span> <span class="n">leftPositionSignal</span><span class="o">.</span><span class="n">getValueAsDouble</span><span class="p">();</span>
</span><span id="line-107"><span class="linenos">107</span>    <span class="n">inputs</span><span class="o">.</span><span class="n">rightPosition</span> <span class="o">=</span> <span class="n">rightPositionSignal</span><span class="o">.</span><span class="n">getValueAsDouble</span><span class="p">();</span>
</span><span id="line-108"><span class="linenos">108</span>    <span class="n">inputs</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">inputs</span><span class="o">.</span><span class="n">rightPosition</span><span class="p">;</span>
</span><span id="line-109"><span class="linenos">109</span>
</span><span id="line-110"><span class="linenos">110</span>    <span class="n">inputs</span><span class="o">.</span><span class="n">reference</span> <span class="o">=</span> <span class="n">reference</span><span class="p">;</span>
</span><span id="line-111"><span class="linenos">111</span>
</span><span id="line-112"><span class="linenos">112</span>    <span class="n">inputs</span><span class="o">.</span><span class="n">zeroCANrangeConnected</span> <span class="o">=</span> <span class="n">BaseStatusSignal</span><span class="o">.</span><span class="n">isAllGood</span><span class="p">(</span>
</span><span id="line-113"><span class="linenos">113</span>        <span class="n">CANrangeDetectedSignal</span><span class="p">,</span>
</span><span id="line-114"><span class="linenos">114</span>        <span class="n">CANrangeDistanceSignal</span><span class="p">,</span>
</span><span id="line-115"><span class="linenos">115</span>        <span class="n">CANrangeStrengthSignal</span><span class="p">);</span>
</span><span id="line-116"><span class="linenos">116</span>    <span class="n">inputs</span><span class="o">.</span><span class="n">zeroCANrangeDetected</span> <span class="o">=</span> <span class="n">CANrangeDetectedSignal</span><span class="o">.</span><span class="n">getValue</span><span class="p">();</span>
</span><span id="line-117"><span class="linenos">117</span>    <span class="n">inputs</span><span class="o">.</span><span class="n">zeroCANrangeDistance</span> <span class="o">=</span> <span class="n">CANrangeDistanceSignal</span><span class="o">.</span><span class="n">getValueAsDouble</span><span class="p">();</span>
</span><span id="line-118"><span class="linenos">118</span>    <span class="n">inputs</span><span class="o">.</span><span class="n">zeroCANrangeStrength</span> <span class="o">=</span> <span class="n">CANrangeStrengthSignal</span><span class="o">.</span><span class="n">getValueAsDouble</span><span class="p">();</span>
</span><span id="line-119"><span class="linenos">119</span>  <span class="p">}</span>
</span><span id="line-120"><span class="linenos">120</span>
</span><span id="line-121"><span class="linenos">121</span>  <span class="n">public</span> <span class="n">void</span> <span class="n">setPosition</span><span class="p">(</span><span class="n">double</span> <span class="n">reference</span><span class="p">)</span> <span class="p">{</span>
</span><span id="line-122"><span class="linenos">122</span>    <span class="n">rightMotor</span><span class="o">.</span><span class="n">setControl</span><span class="p">(</span><span class="n">control</span><span class="o">.</span><span class="n">withPosition</span><span class="p">(</span><span class="n">reference</span><span class="p">));</span>
</span><span id="line-123"><span class="linenos">123</span>    <span class="n">this</span><span class="o">.</span><span class="n">reference</span> <span class="o">=</span> <span class="n">reference</span><span class="p">;</span>
</span><span id="line-124"><span class="linenos">124</span>  <span class="p">}</span>
</span><span id="line-125"><span class="linenos">125</span>
</span><span id="line-126"><span class="linenos">126</span>  <span class="n">public</span> <span class="n">void</span> <span class="n">setVoltage</span><span class="p">(</span><span class="n">double</span> <span class="n">voltage</span><span class="p">)</span> <span class="p">{</span>
</span><span id="line-127"><span class="linenos">127</span>    <span class="n">rightMotor</span><span class="o">.</span><span class="n">setVoltage</span><span class="p">(</span><span class="n">voltage</span><span class="p">);</span>
</span><span id="line-128"><span class="linenos">128</span>  <span class="p">}</span>
</span><span id="line-129"><span class="linenos">129</span>
</span><span id="line-130"><span class="linenos">130</span>  <span class="n">public</span> <span class="n">void</span> <span class="n">enableLimits</span><span class="p">()</span> <span class="p">{</span>
</span><span id="line-131"><span class="linenos">131</span>    <span class="n">rightMotor</span><span class="o">.</span><span class="n">getConfigurator</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">ElevatorConstants</span><span class="o">.</span><span class="n">kMotorConfig</span><span class="o">.</span><span class="n">SoftwareLimitSwitch</span><span class="p">);</span>
</span><span id="line-132"><span class="linenos">132</span>    <span class="n">leftMotor</span><span class="o">.</span><span class="n">getConfigurator</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">ElevatorConstants</span><span class="o">.</span><span class="n">kMotorConfig</span><span class="o">.</span><span class="n">SoftwareLimitSwitch</span><span class="p">);</span>
</span><span id="line-133"><span class="linenos">133</span>  <span class="p">}</span>
</span><span id="line-134"><span class="linenos">134</span>
</span><span id="line-135"><span class="linenos">135</span>  <span class="n">public</span> <span class="n">void</span> <span class="n">disableLimits</span><span class="p">()</span> <span class="p">{</span>
</span><span id="line-136"><span class="linenos">136</span>    <span class="n">rightMotor</span><span class="o">.</span><span class="n">getConfigurator</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">noLimits</span><span class="p">);</span>
</span><span id="line-137"><span class="linenos">137</span>    <span class="n">leftMotor</span><span class="o">.</span><span class="n">getConfigurator</span><span class="p">()</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="n">noLimits</span><span class="p">);</span>
</span><span id="line-138"><span class="linenos">138</span>  <span class="p">}</span>
</span><span id="line-139"><span class="linenos">139</span>
</span><span id="line-140"><span class="linenos">140</span>  <span class="n">public</span> <span class="n">void</span> <span class="n">calibrateZero</span><span class="p">()</span> <span class="p">{</span>
</span><span id="line-141"><span class="linenos">141</span>    <span class="n">rightMotor</span><span class="o">.</span><span class="n">setPosition</span><span class="p">(</span><span class="mf">0.0</span><span class="p">);</span>
</span><span id="line-142"><span class="linenos">142</span>    <span class="n">leftMotor</span><span class="o">.</span><span class="n">setPosition</span><span class="p">(</span><span class="mf">0.0</span><span class="p">);</span>
</span><span id="line-143"><span class="linenos">143</span>  <span class="p">}</span>
</span><span id="line-144"><span class="linenos">144</span><span class="p">}</span>
</span></code></pre></div>
</div>
</div>
<p>This class supplies the basic hardware-facing code needed to control a physical
elevator with two <code class="docutils literal notranslate"><span class="pre">TalonFX</span></code> motor controllers.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you’re curious about the many, many <code class="docutils literal notranslate"><span class="pre">StatusSignal</span></code>s throughout
this code, read the section <a class="reference internal" href="../3_2_status_signals.html"><span class="doc">3.2 - Tips for CTRE Status Signals</span></a>.</p>
</div>
<p>Now, let’s look at another class that implements <code class="docutils literal notranslate"><span class="pre">ElevatorIO</span></code>, but instead
runs a (very basic) simulation of the system:</p>
<div class="literal-block-wrapper docutils container" id="id5">
<div class="code-block-caption"><span class="caption-text">ElevatorIOSim.java</span><a @click.prevent="window.navigator.clipboard.writeText($el.href); $el.setAttribute('data-tooltip', 'Copied!'); setTimeout(() =&gt; $el.setAttribute('data-tooltip', 'Copy link to this element'), 2000)" aria-label="Copy link to this element" class="headerlink" data-tooltip="Copy link to this element" href="#id5"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="linenos"> 1</span><span class="n">package</span> <span class="n">frc</span><span class="o">.</span><span class="n">robot</span><span class="o">.</span><span class="n">subsystems</span><span class="o">.</span><span class="n">elevator</span><span class="p">;</span>
</span><span id="line-2"><span class="linenos"> 2</span>
</span><span id="line-3"><span class="linenos"> 3</span><span class="n">public</span> <span class="k">class</span><span class="w"> </span><span class="nc">ElevatorIOSim</span> <span class="n">implements</span> <span class="n">ElevatorIO</span> <span class="p">{</span>
</span><span id="line-4"><span class="linenos"> 4</span>  <span class="n">private</span> <span class="n">double</span> <span class="n">position</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span><span id="line-5"><span class="linenos"> 5</span>  <span class="n">private</span> <span class="n">double</span> <span class="n">reference</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
</span><span id="line-6"><span class="linenos"> 6</span>
</span><span id="line-7"><span class="linenos"> 7</span>  <span class="n">public</span> <span class="n">void</span> <span class="n">updateInputs</span><span class="p">(</span><span class="n">ElevatorIOInputs</span> <span class="n">inputs</span><span class="p">)</span> <span class="p">{</span>
</span><span id="line-8"><span class="linenos"> 8</span>    <span class="n">position</span> <span class="o">=</span> <span class="mf">0.9</span> <span class="o">*</span> <span class="n">position</span> <span class="o">+</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">reference</span><span class="p">;</span>
</span><span id="line-9"><span class="linenos"> 9</span>    <span class="n">inputs</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">position</span><span class="p">;</span>
</span><span id="line-10"><span class="linenos">10</span>    <span class="n">inputs</span><span class="o">.</span><span class="n">reference</span> <span class="o">=</span> <span class="n">reference</span><span class="p">;</span>
</span><span id="line-11"><span class="linenos">11</span>    <span class="n">inputs</span><span class="o">.</span><span class="n">zeroCANrangeDetected</span> <span class="o">=</span> <span class="n">position</span> <span class="o">&lt;</span> <span class="mf">1e-3</span><span class="p">;</span>
</span><span id="line-12"><span class="linenos">12</span>  <span class="p">}</span>
</span><span id="line-13"><span class="linenos">13</span>
</span><span id="line-14"><span class="linenos">14</span>  <span class="n">public</span> <span class="n">void</span> <span class="n">setPosition</span><span class="p">(</span><span class="n">double</span> <span class="n">position</span><span class="p">)</span> <span class="p">{</span>
</span><span id="line-15"><span class="linenos">15</span>    <span class="n">reference</span> <span class="o">=</span> <span class="n">position</span><span class="p">;</span>
</span><span id="line-16"><span class="linenos">16</span>  <span class="p">}</span>
</span><span id="line-17"><span class="linenos">17</span>
</span><span id="line-18"><span class="linenos">18</span>  <span class="n">public</span> <span class="n">void</span> <span class="n">setVoltage</span><span class="p">(</span><span class="n">double</span> <span class="n">voltage</span><span class="p">)</span> <span class="p">{}</span>
</span><span id="line-19"><span class="linenos">19</span>  
</span><span id="line-20"><span class="linenos">20</span>  <span class="n">public</span> <span class="n">void</span> <span class="n">enableLimits</span><span class="p">()</span> <span class="p">{}</span>
</span><span id="line-21"><span class="linenos">21</span>  <span class="n">public</span> <span class="n">void</span> <span class="n">disableLimits</span><span class="p">()</span> <span class="p">{}</span>
</span><span id="line-22"><span class="linenos">22</span>
</span><span id="line-23"><span class="linenos">23</span>  <span class="n">public</span> <span class="n">void</span> <span class="n">calibrateZero</span><span class="p">()</span> <span class="p">{}</span>
</span><span id="line-24"><span class="linenos">24</span>
</span><span id="line-25"><span class="linenos">25</span><span class="p">}</span>
</span></code></pre></div>
</div>
</div>
<p>Notice that the implementation is completely different. Some methods, such as
<code class="docutils literal notranslate"><span class="pre">enableLimits()</span></code>, are simply no-ops that don’t do anything in simulation.
This doesn’t actually accurately simulate the elevator, but that’s OK. For
basic simulation tests, it’s acceptable to have a subsystem that doesn’t model
all the complex real-world factors. If we wanted, we could create another class
that implements the <code class="docutils literal notranslate"><span class="pre">ElevatorIO</span></code> interface (maybe call it
<code class="docutils literal notranslate"><span class="pre">ElevatorIOAdvancedSim</span></code>) which would use more powerful simulation technology.
But we don’t have to.</p>
<p>Before we finish this up by looking at the actual <code class="docutils literal notranslate"><span class="pre">Elevator</span></code> class, we need
two more helper files.</p>
<p>Firstly, we may have an <code class="docutils literal notranslate"><span class="pre">ElevatorConstants</span></code> file which stores important
constants about our elevator. Here’s what that may look like:</p>
<div class="literal-block-wrapper docutils container" id="id6">
<div class="code-block-caption"><span class="caption-text">ElevatorConstants.java</span><a @click.prevent="window.navigator.clipboard.writeText($el.href); $el.setAttribute('data-tooltip', 'Copied!'); setTimeout(() =&gt; $el.setAttribute('data-tooltip', 'Copy link to this element'), 2000)" aria-label="Copy link to this element" class="headerlink" data-tooltip="Copy link to this element" href="#id6"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="linenos"> 1</span><span class="n">package</span> <span class="n">frc</span><span class="o">.</span><span class="n">robot</span><span class="o">.</span><span class="n">subsystems</span><span class="o">.</span><span class="n">elevator</span><span class="p">;</span>
</span><span id="line-2"><span class="linenos"> 2</span>
</span><span id="line-3"><span class="linenos"> 3</span><span class="kn">import</span><span class="w"> </span><span class="nn">static</span> <span class="n">edu</span><span class="o">.</span><span class="n">wpi</span><span class="o">.</span><span class="n">first</span><span class="o">.</span><span class="n">units</span><span class="o">.</span><span class="n">Units</span><span class="o">.</span><span class="n">Seconds</span><span class="p">;</span>
</span><span id="line-4"><span class="linenos"> 4</span><span class="o">/*</span> <span class="n">snip</span> <span class="o">*/</span>
</span><span id="line-5"><span class="linenos"> 5</span>
</span><span id="line-6"><span class="linenos"> 6</span><span class="n">public</span> <span class="n">final</span> <span class="k">class</span><span class="w"> </span><span class="nc">ElevatorConstants</span> <span class="p">{</span>
</span><span id="line-7"><span class="linenos"> 7</span>  <span class="n">protected</span> <span class="n">static</span> <span class="n">final</span> <span class="nb">int</span> <span class="n">kLeftMotorID</span> <span class="o">=</span> <span class="mi">51</span><span class="p">;</span>
</span><span id="line-8"><span class="linenos"> 8</span>  <span class="n">protected</span> <span class="n">static</span> <span class="n">final</span> <span class="nb">int</span> <span class="n">kRightMotorID</span> <span class="o">=</span> <span class="mi">52</span><span class="p">;</span>
</span><span id="line-9"><span class="linenos"> 9</span>  <span class="n">protected</span> <span class="n">static</span> <span class="n">final</span> <span class="nb">int</span> <span class="n">kCANrangeID</span> <span class="o">=</span> <span class="mi">53</span><span class="p">;</span>
</span><span id="line-10"><span class="linenos">10</span>
</span><span id="line-11"><span class="linenos">11</span>  <span class="n">protected</span> <span class="n">static</span> <span class="n">final</span> <span class="n">boolean</span> <span class="n">kInvertLeft</span> <span class="o">=</span> <span class="n">true</span><span class="p">;</span>
</span><span id="line-12"><span class="linenos">12</span>
</span><span id="line-13"><span class="linenos">13</span>  <span class="n">protected</span> <span class="n">static</span> <span class="n">final</span> <span class="n">double</span> <span class="n">kSupplyCurrentLimit</span> <span class="o">=</span> <span class="mi">100</span><span class="p">;</span>
</span><span id="line-14"><span class="linenos">14</span>
</span><span id="line-15"><span class="linenos">15</span>  <span class="n">protected</span> <span class="n">static</span> <span class="n">final</span> <span class="n">double</span> <span class="n">kRotorToSensorRatio</span> <span class="o">=</span> <span class="mf">5.2</span><span class="p">;</span>
</span><span id="line-16"><span class="linenos">16</span>  <span class="n">protected</span> <span class="n">static</span> <span class="n">final</span> <span class="n">double</span> <span class="n">kSensorToMechanismRatio</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
</span><span id="line-17"><span class="linenos">17</span>
</span><span id="line-18"><span class="linenos">18</span>  <span class="n">protected</span> <span class="n">static</span> <span class="n">final</span> <span class="n">double</span> <span class="n">kGearRatio</span> <span class="o">=</span> <span class="n">kRotorToSensorRatio</span> <span class="o">*</span> <span class="n">kSensorToMechanismRatio</span><span class="p">;</span>
</span><span id="line-19"><span class="linenos">19</span>
</span><span id="line-20"><span class="linenos">20</span>  <span class="n">private</span> <span class="n">static</span> <span class="n">final</span> <span class="n">double</span> <span class="n">kDrumRadius</span> <span class="o">=</span> <span class="n">Units</span><span class="o">.</span><span class="n">inchesToMeters</span><span class="p">(</span><span class="mf">2.256</span> <span class="o">/</span> <span class="mi">2</span><span class="p">);</span>
</span><span id="line-21"><span class="linenos">21</span>
</span><span id="line-22"><span class="linenos">22</span>  <span class="o">/*</span> <span class="n">snip</span> <span class="o">*/</span>
</span><span id="line-23"><span class="linenos">23</span>
</span><span id="line-24"><span class="linenos">24</span>  <span class="n">protected</span> <span class="n">static</span> <span class="n">final</span> <span class="n">TalonFXConfiguration</span> <span class="n">kMotorConfig</span> <span class="o">=</span> <span class="n">new</span> <span class="n">TalonFXConfiguration</span><span class="p">()</span>
</span><span id="line-25"><span class="linenos">25</span>      <span class="o">.</span><span class="n">withMotorOutput</span><span class="p">(</span><span class="n">new</span> <span class="n">MotorOutputConfigs</span><span class="p">()</span>
</span><span id="line-26"><span class="linenos">26</span>          <span class="o">.</span><span class="n">withNeutralMode</span><span class="p">(</span><span class="n">NeutralModeValue</span><span class="o">.</span><span class="n">Brake</span><span class="p">)</span>
</span><span id="line-27"><span class="linenos">27</span>          <span class="o">.</span><span class="n">withInverted</span><span class="p">(</span><span class="n">InvertedValue</span><span class="o">.</span><span class="n">CounterClockwise_Positive</span><span class="p">))</span>
</span><span id="line-28"><span class="linenos">28</span>
</span><span id="line-29"><span class="linenos">29</span>      <span class="o">.</span><span class="n">withFeedback</span><span class="p">(</span><span class="n">new</span> <span class="n">FeedbackConfigs</span><span class="p">()</span>
</span><span id="line-30"><span class="linenos">30</span>          <span class="o">.</span><span class="n">withFeedbackSensorSource</span><span class="p">(</span><span class="n">FeedbackSensorSourceValue</span><span class="o">.</span><span class="n">RotorSensor</span><span class="p">)</span>
</span><span id="line-31"><span class="linenos">31</span>          <span class="o">.</span><span class="n">withSensorToMechanismRatio</span><span class="p">(</span><span class="n">kGearRatio</span><span class="p">))</span>
</span><span id="line-32"><span class="linenos">32</span>
</span><span id="line-33"><span class="linenos">33</span>      <span class="o">.</span><span class="n">withCurrentLimits</span><span class="p">(</span><span class="n">new</span> <span class="n">CurrentLimitsConfigs</span><span class="p">()</span>
</span><span id="line-34"><span class="linenos">34</span>          <span class="o">.</span><span class="n">withSupplyCurrentLimitEnable</span><span class="p">(</span><span class="n">true</span><span class="p">)</span>
</span><span id="line-35"><span class="linenos">35</span>          <span class="o">.</span><span class="n">withSupplyCurrentLimit</span><span class="p">(</span><span class="n">kSupplyCurrentLimit</span><span class="p">))</span>
</span><span id="line-36"><span class="linenos">36</span>
</span><span id="line-37"><span class="linenos">37</span>      <span class="o">.</span><span class="n">withSoftwareLimitSwitch</span><span class="p">(</span><span class="n">new</span> <span class="n">SoftwareLimitSwitchConfigs</span><span class="p">()</span>
</span><span id="line-38"><span class="linenos">38</span>          <span class="o">.</span><span class="n">withForwardSoftLimitThreshold</span><span class="p">(</span><span class="n">kForwardSoftLimit</span><span class="p">)</span>
</span><span id="line-39"><span class="linenos">39</span>          <span class="o">.</span><span class="n">withForwardSoftLimitEnable</span><span class="p">(</span><span class="n">true</span><span class="p">)</span>
</span><span id="line-40"><span class="linenos">40</span>          <span class="o">.</span><span class="n">withReverseSoftLimitThreshold</span><span class="p">(</span><span class="n">kReverseSoftLimit</span><span class="p">)</span>
</span><span id="line-41"><span class="linenos">41</span>          <span class="o">.</span><span class="n">withReverseSoftLimitEnable</span><span class="p">(</span><span class="n">false</span><span class="p">))</span>
</span><span id="line-42"><span class="linenos">42</span>
</span><span id="line-43"><span class="linenos">43</span>      <span class="o">.</span><span class="n">withSlot0</span><span class="p">(</span><span class="n">new</span> <span class="n">Slot0Configs</span><span class="p">()</span>
</span><span id="line-44"><span class="linenos">44</span>          <span class="o">.</span><span class="n">withGravityType</span><span class="p">(</span><span class="n">GravityTypeValue</span><span class="o">.</span><span class="n">Elevator_Static</span><span class="p">)</span>
</span><span id="line-45"><span class="linenos">45</span>          <span class="o">.</span><span class="n">withKP</span><span class="p">(</span><span class="mi">20</span><span class="p">)</span>
</span><span id="line-46"><span class="linenos">46</span>          <span class="o">.</span><span class="n">withKI</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="line-47"><span class="linenos">47</span>          <span class="o">.</span><span class="n">withKD</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</span><span id="line-48"><span class="linenos">48</span>          <span class="o">.</span><span class="n">withKS</span><span class="p">(</span><span class="mf">0.125</span><span class="p">)</span>
</span><span id="line-49"><span class="linenos">49</span>          <span class="o">.</span><span class="n">withKV</span><span class="p">(</span><span class="mf">3.59</span> <span class="o">*</span> <span class="p">(</span><span class="n">kDrumRadius</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">Math</span><span class="o">.</span><span class="n">PI</span><span class="p">))</span>
</span><span id="line-50"><span class="linenos">50</span>          <span class="o">.</span><span class="n">withKA</span><span class="p">(</span><span class="mf">0.05</span> <span class="o">*</span> <span class="p">(</span><span class="n">kDrumRadius</span> <span class="o">*</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">Math</span><span class="o">.</span><span class="n">PI</span><span class="p">))</span>
</span><span id="line-51"><span class="linenos">51</span>          <span class="o">.</span><span class="n">withKG</span><span class="p">(</span><span class="mf">0.42</span><span class="p">))</span>
</span><span id="line-52"><span class="linenos">52</span>
</span><span id="line-53"><span class="linenos">53</span>      <span class="o">.</span><span class="n">withMotionMagic</span><span class="p">(</span><span class="n">new</span> <span class="n">MotionMagicConfigs</span><span class="p">()</span>
</span><span id="line-54"><span class="linenos">54</span>          <span class="o">.</span><span class="n">withMotionMagicCruiseVelocity</span><span class="p">(</span><span class="n">kMaxSpeed</span><span class="p">)</span>
</span><span id="line-55"><span class="linenos">55</span>          <span class="o">.</span><span class="n">withMotionMagicAcceleration</span><span class="p">(</span><span class="n">kMaxAcceleration</span><span class="p">)</span>
</span><span id="line-56"><span class="linenos">56</span>          <span class="o">.</span><span class="n">withMotionMagicJerk</span><span class="p">(</span><span class="n">kMaxJerk</span><span class="p">));</span>
</span><span id="line-57"><span class="linenos">57</span>
</span><span id="line-58"><span class="linenos">58</span>  <span class="n">protected</span> <span class="n">static</span> <span class="n">final</span> <span class="n">CANrangeConfiguration</span> <span class="n">kCANrangeConfig</span> <span class="o">=</span> <span class="n">new</span> <span class="n">CANrangeConfiguration</span><span class="p">()</span>
</span><span id="line-59"><span class="linenos">59</span>      <span class="o">.</span><span class="n">withFovParams</span><span class="p">(</span><span class="n">new</span> <span class="n">FovParamsConfigs</span><span class="p">()</span>
</span><span id="line-60"><span class="linenos">60</span>          <span class="o">.</span><span class="n">withFOVRangeX</span><span class="p">(</span><span class="mf">6.75</span><span class="p">)</span>
</span><span id="line-61"><span class="linenos">61</span>          <span class="o">.</span><span class="n">withFOVRangeY</span><span class="p">(</span><span class="mf">6.75</span><span class="p">))</span>
</span><span id="line-62"><span class="linenos">62</span>      <span class="o">.</span><span class="n">withProximityParams</span><span class="p">(</span><span class="n">new</span> <span class="n">ProximityParamsConfigs</span><span class="p">()</span>
</span><span id="line-63"><span class="linenos">63</span>          <span class="o">.</span><span class="n">withMinSignalStrengthForValidMeasurement</span><span class="p">(</span><span class="mi">3500</span><span class="p">)</span>
</span><span id="line-64"><span class="linenos">64</span>          <span class="o">.</span><span class="n">withProximityThreshold</span><span class="p">(</span><span class="mf">0.13</span><span class="p">)</span>
</span><span id="line-65"><span class="linenos">65</span>          <span class="o">.</span><span class="n">withProximityHysteresis</span><span class="p">(</span><span class="mi">0</span><span class="p">));</span>
</span><span id="line-66"><span class="linenos">66</span>
</span><span id="line-67"><span class="linenos">67</span>  <span class="n">protected</span> <span class="n">static</span> <span class="n">final</span> <span class="n">Time</span> <span class="n">kRangeDebounceTime</span> <span class="o">=</span> <span class="n">Seconds</span><span class="o">.</span><span class="n">of</span><span class="p">(</span><span class="mf">0.06</span><span class="p">);</span>
</span><span id="line-68"><span class="linenos">68</span>
</span><span id="line-69"><span class="linenos">69</span>  <span class="n">protected</span> <span class="n">static</span> <span class="n">final</span> <span class="n">LinearSystem</span><span class="o">&lt;</span><span class="n">N2</span><span class="p">,</span> <span class="n">N1</span><span class="p">,</span> <span class="n">N2</span><span class="o">&gt;</span> <span class="n">kPlant</span> <span class="o">=</span>
</span><span id="line-70"><span class="linenos">70</span>      <span class="n">LinearSystemId</span><span class="o">.</span><span class="n">createElevatorSystem</span><span class="p">(</span><span class="n">DCMotor</span><span class="o">.</span><span class="n">getKrakenX60</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">);</span>
</span><span id="line-71"><span class="linenos">71</span>  <span class="n">public</span> <span class="n">static</span> <span class="n">final</span> <span class="n">double</span> <span class="n">kCalibrationTime</span> <span class="o">=</span> <span class="mf">3.5</span><span class="p">;</span> <span class="o">//</span> <span class="n">seconds</span>
</span><span id="line-72"><span class="linenos">72</span><span class="p">}</span>
</span><span id="line-73"><span class="linenos">73</span>
</span><span id="line-74"><span class="linenos">74</span>      
</span><span id="line-75"><span class="linenos">75</span> 
</span></code></pre></div>
</div>
</div>
<p>This class is rather straightforward; if there’s any constants about your
subsystem, you can put them here.</p>
<p>Another simple yet important class is an enum class that represents valid
elevator setpoints. We call this one <code class="docutils literal notranslate"><span class="pre">ElevatorState</span></code>:</p>
<div class="literal-block-wrapper docutils container" id="id7">
<div class="code-block-caption"><span class="caption-text">ElevatorState.java</span><a @click.prevent="window.navigator.clipboard.writeText($el.href); $el.setAttribute('data-tooltip', 'Copied!'); setTimeout(() =&gt; $el.setAttribute('data-tooltip', 'Copy link to this element'), 2000)" aria-label="Copy link to this element" class="headerlink" data-tooltip="Copy link to this element" href="#id7"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="linenos"> 1</span><span class="n">package</span> <span class="n">frc</span><span class="o">.</span><span class="n">robot</span><span class="o">.</span><span class="n">subsystems</span><span class="o">.</span><span class="n">elevator</span><span class="p">;</span>
</span><span id="line-2"><span class="linenos"> 2</span>
</span><span id="line-3"><span class="linenos"> 3</span><span class="n">public</span> <span class="n">enum</span> <span class="n">ElevatorState</span> <span class="p">{</span>
</span><span id="line-4"><span class="linenos"> 4</span>  <span class="o">/**</span> <span class="n">Elevator</span> <span class="n">at</span> <span class="n">lowest</span> <span class="n">position</span> <span class="o">*/</span>
</span><span id="line-5"><span class="linenos"> 5</span>  <span class="n">Zero</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
</span><span id="line-6"><span class="linenos"> 6</span>  <span class="o">/**</span> <span class="n">Elevator</span> <span class="n">at</span> <span class="n">ground</span> <span class="n">algae</span> <span class="n">intake</span> <span class="n">height</span><span class="o">*/</span>
</span><span id="line-7"><span class="linenos"> 7</span>  <span class="n">Ground</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
</span><span id="line-8"><span class="linenos"> 8</span>  <span class="o">/**</span> <span class="n">Height</span> <span class="k">for</span> <span class="n">ground</span> <span class="n">algae</span> <span class="n">intake</span> <span class="o">*/</span>
</span><span id="line-9"><span class="linenos"> 9</span>  <span class="n">HighGround</span><span class="p">(</span><span class="mf">0.60</span><span class="p">),</span>
</span><span id="line-10"><span class="linenos">10</span>  <span class="o">/**</span> <span class="n">Regular</span> <span class="s2">"home"</span> <span class="n">position</span> <span class="o">-</span> <span class="n">also</span> <span class="n">intake</span> <span class="n">position</span> <span class="o">*/</span>
</span><span id="line-11"><span class="linenos">11</span>  <span class="n">Stow</span><span class="p">(</span><span class="mf">0.31</span><span class="p">),</span>
</span><span id="line-12"><span class="linenos">12</span>  <span class="o">/**</span> <span class="n">A</span> <span class="n">little</span> <span class="n">higher</span> <span class="n">than</span> <span class="n">stow</span> <span class="n">to</span> <span class="n">eject</span> <span class="n">a</span> <span class="n">coral</span> <span class="o">*/</span>
</span><span id="line-13"><span class="linenos">13</span>  <span class="n">Eject</span><span class="p">(</span><span class="n">ElevatorState</span><span class="o">.</span><span class="n">Stow</span><span class="o">.</span><span class="n">position</span><span class="p">()</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">ElevatorConstants</span><span class="o">.</span><span class="n">kInch</span><span class="p">),</span>
</span><span id="line-14"><span class="linenos">14</span>  <span class="o">/**</span> <span class="n">Height</span> <span class="n">to</span> <span class="n">score</span> <span class="n">processor</span> <span class="o">*/</span>
</span><span id="line-15"><span class="linenos">15</span>  <span class="n">Processor</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
</span><span id="line-16"><span class="linenos">16</span>  <span class="o">/**</span> <span class="n">L1</span> <span class="n">height</span> <span class="o">*/</span>
</span><span id="line-17"><span class="linenos">17</span>  <span class="n">L1</span><span class="p">(</span><span class="mf">2.63</span><span class="p">),</span>
</span><span id="line-18"><span class="linenos">18</span>  <span class="o">/**</span> <span class="n">Secondary</span> <span class="n">L1</span> <span class="n">height</span> <span class="k">for</span> <span class="n">when</span> <span class="n">a</span> <span class="n">coral</span> <span class="ow">is</span> <span class="n">already</span> <span class="n">present</span> <span class="o">*/</span>
</span><span id="line-19"><span class="linenos">19</span>  <span class="n">SecondaryL1</span><span class="p">(</span><span class="n">ElevatorState</span><span class="o">.</span><span class="n">L1</span><span class="o">.</span><span class="n">position</span><span class="p">()</span> <span class="o">+</span> <span class="mi">8</span> <span class="o">*</span> <span class="n">ElevatorConstants</span><span class="o">.</span><span class="n">kInch</span><span class="p">),</span>
</span><span id="line-20"><span class="linenos">20</span>  <span class="o">/**</span> <span class="n">L2</span> <span class="n">height</span> <span class="o">*/</span>
</span><span id="line-21"><span class="linenos">21</span>  <span class="n">L2</span><span class="p">(</span><span class="mf">4.016</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">ElevatorConstants</span><span class="o">.</span><span class="n">kInch</span><span class="p">),</span>
</span><span id="line-22"><span class="linenos">22</span>  <span class="o">/**</span> <span class="n">L3</span> <span class="n">height</span> <span class="o">*/</span>
</span><span id="line-23"><span class="linenos">23</span>  <span class="n">L3</span><span class="p">(</span><span class="mf">7.257</span> <span class="o">-</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">ElevatorConstants</span><span class="o">.</span><span class="n">kInch</span><span class="p">),</span>
</span><span id="line-24"><span class="linenos">24</span>  <span class="o">/**</span> <span class="n">L4</span> <span class="n">height</span> <span class="o">*/</span>
</span><span id="line-25"><span class="linenos">25</span>  <span class="n">L4</span><span class="p">(</span><span class="mf">9.757</span> <span class="o">+</span> <span class="mf">0.3</span> <span class="o">*</span> <span class="n">ElevatorConstants</span><span class="o">.</span><span class="n">kInch</span><span class="p">),</span>
</span><span id="line-26"><span class="linenos">26</span>  <span class="o">/**</span> <span class="n">Height</span> <span class="n">to</span> <span class="n">score</span> <span class="n">net</span> <span class="o">*/</span>
</span><span id="line-27"><span class="linenos">27</span>  <span class="n">Net</span><span class="p">(</span><span class="mf">9.31</span> <span class="o">+</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">ElevatorConstants</span><span class="o">.</span><span class="n">kInch</span><span class="p">),</span>
</span><span id="line-28"><span class="linenos">28</span>  <span class="o">/**</span> <span class="n">Height</span> <span class="n">to</span> <span class="n">intake</span> <span class="n">algae</span> <span class="kn">from</span><span class="w"> </span><span class="nn">lower</span> <span class="n">reef</span> <span class="o">*/</span>
</span><span id="line-29"><span class="linenos">29</span>  <span class="n">LowerReef</span><span class="p">(</span><span class="mf">2.0</span><span class="p">),</span>
</span><span id="line-30"><span class="linenos">30</span>  <span class="o">/**</span> <span class="n">Height</span> <span class="n">to</span> <span class="n">intake</span> <span class="n">algae</span> <span class="kn">from</span><span class="w"> </span><span class="nn">upper</span> <span class="n">reef</span> <span class="o">*/</span>
</span><span id="line-31"><span class="linenos">31</span>  <span class="n">UpperReef</span><span class="p">(</span><span class="mf">4.5</span> <span class="o">-</span> <span class="mi">3</span> <span class="o">*</span> <span class="n">ElevatorConstants</span><span class="o">.</span><span class="n">kInch</span><span class="p">);</span>
</span><span id="line-32"><span class="linenos">32</span>
</span><span id="line-33"><span class="linenos">33</span>  <span class="n">protected</span> <span class="n">final</span> <span class="n">double</span> <span class="n">position</span><span class="p">;</span>
</span><span id="line-34"><span class="linenos">34</span>
</span><span id="line-35"><span class="linenos">35</span>  <span class="n">private</span> <span class="n">ElevatorState</span><span class="p">(</span><span class="n">double</span> <span class="n">position</span><span class="p">)</span> <span class="p">{</span>
</span><span id="line-36"><span class="linenos">36</span>    <span class="n">this</span><span class="o">.</span><span class="n">position</span> <span class="o">=</span> <span class="n">position</span><span class="p">;</span>
</span><span id="line-37"><span class="linenos">37</span>  <span class="p">}</span>
</span><span id="line-38"><span class="linenos">38</span><span class="p">}</span>
</span></code></pre></div>
</div>
</div>
<p>Notice that the actual position values are hidden from any code outside the
package <code class="docutils literal notranslate"><span class="pre">frc.robot.subsystems.elevator</span></code>, meaning anywhere outside the
subsystem package, if a setpoint needs to be set, it <em>must</em> use the clear enum
types rather than “magic numbers”.</p>
<p>Finally, we can take a look at the <code class="docutils literal notranslate"><span class="pre">Elevator</span></code> subsystem class:</p>
<div class="literal-block-wrapper docutils container" id="id8">
<div class="code-block-caption"><span class="caption-text">Elevator.java</span><a @click.prevent="window.navigator.clipboard.writeText($el.href); $el.setAttribute('data-tooltip', 'Copied!'); setTimeout(() =&gt; $el.setAttribute('data-tooltip', 'Copy link to this element'), 2000)" aria-label="Copy link to this element" class="headerlink" data-tooltip="Copy link to this element" href="#id8"><svg height="1em" viewbox="0 0 24 24" width="1em" xmlns="http://www.w3.org/2000/svg"><path d="M3.9 12c0-1.71 1.39-3.1 3.1-3.1h4V7H7c-2.76 0-5 2.24-5 5s2.24 5 5 5h4v-1.9H7c-1.71 0-3.1-1.39-3.1-3.1zM8 13h8v-2H8v2zm9-6h-4v1.9h4c1.71 0 3.1 1.39 3.1 3.1s-1.39 3.1-3.1 3.1h-4V17h4c2.76 0 5-2.24 5-5s-2.24-5-5-5z"></path></svg></a></div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><code><span id="line-1"><span class="linenos">  1</span>// Copyright (c) FIRST and other WPILib contributors.
</span><span id="line-2"><span class="linenos">  2</span>// Open Source Software; you can modify and/or share it under the terms of
</span><span id="line-3"><span class="linenos">  3</span>// the WPILib BSD license file in the root directory of this project.
</span><span id="line-4"><span class="linenos">  4</span>
</span><span id="line-5"><span class="linenos">  5</span>package frc.robot.subsystems.elevator;
</span><span id="line-6"><span class="linenos">  6</span>
</span><span id="line-7"><span class="linenos">  7</span>import static edu.wpi.first.units.Units.Seconds;
</span><span id="line-8"><span class="linenos">  8</span>
</span><span id="line-9"><span class="linenos">  9</span>import org.slf4j.Logger;
</span><span id="line-10"><span class="linenos"> 10</span>import org.slf4j.LoggerFactory;
</span><span id="line-11"><span class="linenos"> 11</span>
</span><span id="line-12"><span class="linenos"> 12</span>import edu.wpi.first.math.filter.Debouncer;
</span><span id="line-13"><span class="linenos"> 13</span>import edu.wpi.first.wpilibj.smartdashboard.SmartDashboard;
</span><span id="line-14"><span class="linenos"> 14</span>import edu.wpi.first.wpilibj2.command.Command;
</span><span id="line-15"><span class="linenos"> 15</span>import edu.wpi.first.wpilibj2.command.Commands;
</span><span id="line-16"><span class="linenos"> 16</span>import edu.wpi.first.wpilibj2.command.button.Trigger;
</span><span id="line-17"><span class="linenos"> 17</span>import frc.robot.Constants.CoralLevel;
</span><span id="line-18"><span class="linenos"> 18</span>import frc.robot.Robot;
</span><span id="line-19"><span class="linenos"> 19</span>import frc.robot.RobotObserver;
</span><span id="line-20"><span class="linenos"> 20</span>import frc.robot.subsystems.PassiveSubsystem;
</span><span id="line-21"><span class="linenos"> 21</span>import frc.robot.subsystems.elevator.ElevatorIO.ElevatorIOInputs;
</span><span id="line-22"><span class="linenos"> 22</span>import frc.robot.utils.LoopTimer;
</span><span id="line-23"><span class="linenos"> 23</span>import frc.robot.utils.OnboardLogger;
</span><span id="line-24"><span class="linenos"> 24</span>
</span><span id="line-25"><span class="linenos"> 25</span>public class Elevator extends PassiveSubsystem {
</span><span id="line-26"><span class="linenos"> 26</span>  private final ElevatorIO io;
</span><span id="line-27"><span class="linenos"> 27</span>  private final ElevatorIOInputs inputs;
</span><span id="line-28"><span class="linenos"> 28</span>
</span><span id="line-29"><span class="linenos"> 29</span>  private final OnboardLogger ologger;
</span><span id="line-30"><span class="linenos"> 30</span>
</span><span id="line-31"><span class="linenos"> 31</span>  private final Debouncer debouncer = new Debouncer(ElevatorConstants.kRangeDebounceTime.in(Seconds));
</span><span id="line-32"><span class="linenos"> 32</span>
</span><span id="line-33"><span class="linenos"> 33</span>  public ElevatorState reference = ElevatorState.Stow;
</span><span id="line-34"><span class="linenos"> 34</span>
</span><span id="line-35"><span class="linenos"> 35</span>  public Elevator() {
</span><span id="line-36"><span class="linenos"> 36</span>    super();
</span><span id="line-37"><span class="linenos"> 37</span>    if (Robot.isReal()) {
</span><span id="line-38"><span class="linenos"> 38</span>      io = new ElevatorIOHardware();
</span><span id="line-39"><span class="linenos"> 39</span>    } else {
</span><span id="line-40"><span class="linenos"> 40</span>      io = new ElevatorIOSim();
</span><span id="line-41"><span class="linenos"> 41</span>    }
</span><span id="line-42"><span class="linenos"> 42</span>    inputs = new ElevatorIOInputs();
</span><span id="line-43"><span class="linenos"> 43</span>  }
</span><span id="line-44"><span class="linenos"> 44</span>
</span><span id="line-45"><span class="linenos"> 45</span>  private void setPosition(ElevatorState state) {
</span><span id="line-46"><span class="linenos"> 46</span>    // calculate goal we should go to
</span><span id="line-47"><span class="linenos"> 47</span>    double goal = state.position;
</span><span id="line-48"><span class="linenos"> 48</span>    // floor values for the goal between our two extrema
</span><span id="line-49"><span class="linenos"> 49</span>    goal = Math.min(goal, ElevatorConstants.kForwardSoftLimit);
</span><span id="line-50"><span class="linenos"> 50</span>    goal = Math.max(goal, ElevatorConstants.kReverseSoftLimit);
</span><span id="line-51"><span class="linenos"> 51</span>    io.setPosition(goal);
</span><span id="line-52"><span class="linenos"> 52</span>    reference = state;
</span><span id="line-53"><span class="linenos"> 53</span>  }
</span><span id="line-54"><span class="linenos"> 54</span>
</span><span id="line-55"><span class="linenos"> 55</span>  public Trigger atSetpoint() {
</span><span id="line-56"><span class="linenos"> 56</span>    return new Trigger(
</span><span id="line-57"><span class="linenos"> 57</span>        () -&gt; Math.abs(reference.position - inputs.position) &lt; ElevatorConstants.kTolerance);
</span><span id="line-58"><span class="linenos"> 58</span>  }
</span><span id="line-59"><span class="linenos"> 59</span>
</span><span id="line-60"><span class="linenos"> 60</span>  public Trigger ready(ElevatorState state) {
</span><span id="line-61"><span class="linenos"> 61</span>    return atSetpoint().and(new Trigger(() -&gt; reference.equals(state)));
</span><span id="line-62"><span class="linenos"> 62</span>  }
</span><span id="line-63"><span class="linenos"> 63</span>
</span><span id="line-64"><span class="linenos"> 64</span>  private boolean atZero() {
</span><span id="line-65"><span class="linenos"> 65</span>    return debouncer.calculate(inputs.zeroCANrangeDetected);
</span><span id="line-66"><span class="linenos"> 66</span>  }
</span><span id="line-67"><span class="linenos"> 67</span>
</span><span id="line-68"><span class="linenos"> 68</span>  @Override
</span><span id="line-69"><span class="linenos"> 69</span>  public void periodic() {
</span><span id="line-70"><span class="linenos"> 70</span>    io.updateInputs(inputs);
</span><span id="line-71"><span class="linenos"> 71</span>  }
</span><span id="line-72"><span class="linenos"> 72</span>
</span><span id="line-73"><span class="linenos"> 73</span>  /**
</span><span id="line-74"><span class="linenos"> 74</span>   * Whether or not the elevator is above the "safe" range
</span><span id="line-75"><span class="linenos"> 75</span>   */
</span><span id="line-76"><span class="linenos"> 76</span>  public Trigger unsafe() {
</span><span id="line-77"><span class="linenos"> 77</span>    return new Trigger(() -&gt; inputs.position &gt;= ElevatorConstants.kUnsafeRange
</span><span id="line-78"><span class="linenos"> 78</span>        || reference.position &gt;= ElevatorConstants.kUnsafeRange);
</span><span id="line-79"><span class="linenos"> 79</span>  }
</span><span id="line-80"><span class="linenos"> 80</span>
</span><span id="line-81"><span class="linenos"> 81</span>  public Command go(ElevatorState state) {
</span><span id="line-82"><span class="linenos"> 82</span>    return Commands.sequence(
</span><span id="line-83"><span class="linenos"> 83</span>        runOnce(() -&gt; setPosition(state)),
</span><span id="line-84"><span class="linenos"> 84</span>        Commands.waitUntil(atSetpoint()))
</span><span id="line-85"><span class="linenos"> 85</span>        .withName("Elevator(" + state.toString() + ")");
</span><span id="line-86"><span class="linenos"> 86</span>  }
</span><span id="line-87"><span class="linenos"> 87</span>
</span><span id="line-88"><span class="linenos"> 88</span>  /**
</span><span id="line-89"><span class="linenos"> 89</span>   * Automatically zeroes the elevator.
</span><span id="line-90"><span class="linenos"> 90</span>   */
</span><span id="line-91"><span class="linenos"> 91</span>  public Command autoZero() {
</span><span id="line-92"><span class="linenos"> 92</span>    return Commands.waitUntil(this::atZero).deadlineFor(
</span><span id="line-93"><span class="linenos"> 93</span>        Commands.sequence(
</span><span id="line-94"><span class="linenos"> 94</span>            go(ElevatorState.Zero),
</span><span id="line-95"><span class="linenos"> 95</span>            runOnce(io::disableLimits),
</span><span id="line-96"><span class="linenos"> 96</span>            runOnce(() -&gt; io.setVoltage(ElevatorConstants.kZeroVoltage))))
</span><span id="line-97"><span class="linenos"> 97</span>
</span><span id="line-98"><span class="linenos"> 98</span>        .finallyDo(io::enableLimits)
</span><span id="line-99"><span class="linenos"> 99</span>        .finallyDo(interrupted -&gt; {
</span><span id="line-100"><span class="linenos">100</span>          if (!interrupted) {
</span><span id="line-101"><span class="linenos">101</span>            io.calibrateZero();
</span><span id="line-102"><span class="linenos">102</span>          }
</span><span id="line-103"><span class="linenos">103</span>        })
</span><span id="line-104"><span class="linenos">104</span>        .withName("Autozero");
</span><span id="line-105"><span class="linenos">105</span>  }
</span><span id="line-106"><span class="linenos">106</span>}
</span></code></pre></div>
</div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This is a trimmed version of the subsystem. Not all the code is here,
only that which is actually relevant to readythis section.</p>
</div>
</section>
</section>
</div><div class="flex justify-between items-center pt-6 mt-12 border-t border-border gap-4">
<div class="mr-auto">
<a class="inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors border border-input hover:bg-accent hover:text-accent-foreground py-2 px-4" href="index.html">
<svg class="mr-2 h-4 w-4" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<polyline points="15 18 9 12 15 6"></polyline>
</svg>
        3.1 - Program Structure
      </a>
</div>
<div class="ml-auto">
<a class="inline-flex items-center justify-center rounded-md text-sm font-medium transition-colors border border-input hover:bg-accent hover:text-accent-foreground py-2 px-4" href="3_1_2_superstructure.html">
        3.1.2 - Superstructures and States
        <svg class="ml-2 h-4 w-4" fill="none" height="24" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" viewbox="0 0 24 24" width="24" xmlns="http://www.w3.org/2000/svg">
<polyline points="9 18 15 12 9 6"></polyline>
</svg>
</a>
</div>
</div></div><aside class="hidden text-sm xl:block" id="right-sidebar">
<div class="sticky top-16 -mt-10 max-h-[calc(100vh-5rem)] overflow-y-auto pt-6 space-y-2"><p class="font-medium">On this page</p>
<ul>
<li><a :data-current="activeSection === '#describe-state-categorically'" class="reference internal" href="#describe-state-categorically">Describe state categorically</a></li>
<li><a :data-current="activeSection === '#expose-triggers-not-booleans'" class="reference internal" href="#expose-triggers-not-booleans">Expose <code class="docutils literal notranslate"><span class="pre">Trigger</span></code>s, not <code class="docutils literal notranslate"><span class="pre">boolean</span></code>s</a></li>
<li><a :data-current="activeSection === '#return-commands'" class="reference internal" href="#return-commands">Return <code class="docutils literal notranslate"><span class="pre">Command</span></code>s</a></li>
<li><a :data-current="activeSection === '#use-enums-extensively'" class="reference internal" href="#use-enums-extensively">Use enums extensively</a></li>
<li><a :data-current="activeSection === '#separate-hardware-logic-from-subsystem-logic'" class="reference internal" href="#separate-hardware-logic-from-subsystem-logic">Separate hardware logic from subsystem logic</a><ul>
<li><a :data-current="activeSection === '#cache-state'" class="reference internal" href="#cache-state">Cache State</a></li>
<li><a :data-current="activeSection === '#use-interfaces'" class="reference internal" href="#use-interfaces">Use interfaces</a></li>
</ul>
</li>
<li><a :data-current="activeSection === '#example-subsystem-elevator'" class="reference internal" href="#example-subsystem-elevator">Example subsystem: Elevator</a></li>
</ul>
</div>
</aside>
</main>
</div>
</div><footer class="py-6 border-t border-border md:py-0">
<div class="container flex flex-col items-center justify-between gap-4 md:h-24 md:flex-row">
<div class="flex flex-col items-center gap-4 px-8 md:flex-row md:gap-2 md:px-0">
<p class="text-sm leading-loose text-center text-muted-foreground md:text-left">© 2025, Nolan Barker Built with <a class="font-medium underline underline-offset-4" href="https://www.sphinx-doc.org" rel="noreferrer">Sphinx 8.2.3</a></p>
</div>
</div>
</footer>
</div><button :class="{'opacity-0 invisible' : !showScrollTop}" @click="window.scrollTo({top: 0, behavior: 'smooth'})" class="fixed bottom-8 right-8 p-2 z-10 rounded-sm bg-gray-700 text-xs text-white transition-all duration-1000 hover:bg-gray-950 focus:bg-gray-950" id="scrolltop" x-cloak="">
<svg aria-hidden="true" class="inline fill-current mb-[2px]" height="14" viewbox="0 96 960 960" width="14" xmlns="http://www.w3.org/2000/svg">
<path d="M450 896V370L202 618l-42-42 320-320 320 320-42 42-248-248v526h-60Z"></path>
</svg>
  Back to top
</button>
<script src="../../_static/documentation_options.js?v=5929fcd5"></script>
<script src="../../_static/doctools.js?v=9bcbadda"></script>
<script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
<script defer="defer" src="../../_static/theme.js?v=073f68d9"></script>
</body>
</html>